******************************************
******************************************
NF = 40, M = 20, Nimp = 1
******************************************
[[-0.25   0.     0.01  ...  0.     0.01   0.   ]
 [ 0.    -0.25   0.    ...  0.013  0.     0.01 ]
 [ 0.01   0.    -0.947 ...  0.     0.     0.   ]
 ...
 [ 0.     0.013  0.    ...  0.842  0.     0.   ]
 [ 0.01   0.     0.    ...  0.     0.947  0.   ]
 [ 0.     0.01   0.    ...  0.     0.     0.947]]
************
[[-0.25   0.01   0.013  0.015  0.016  0.017  0.017  0.018  0.018  0.018  0.018  0.018  0.018  0.018  0.017  0.017  0.016  0.015  0.013  0.01 ]
 [ 0.01  -0.947  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.013  0.    -0.842  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.015  0.     0.    -0.737  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.016  0.     0.     0.    -0.632  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.017  0.     0.     0.     0.    -0.526  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.017  0.     0.     0.     0.     0.    -0.421  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.018  0.     0.     0.     0.     0.     0.    -0.316  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.018  0.     0.     0.     0.     0.     0.     0.    -0.211  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.018  0.     0.     0.     0.     0.     0.     0.     0.    -0.105  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.018  0.     0.     0.     0.     0.     0.     0.     0.     0.    -0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.018  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.105  0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.018  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.211  0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.018  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.316  0.     0.     0.     0.     0.     0.   ]
 [ 0.017  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.421  0.     0.     0.     0.     0.   ]
 [ 0.017  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.526  0.     0.     0.     0.   ]
 [ 0.016  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.632  0.     0.     0.   ]
 [ 0.015  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.737  0.     0.   ]
 [ 0.013  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.842  0.   ]
 [ 0.01   0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.947]]
U((0, 0, 0, 0)) = (0.5+0j)
setting to 0
U((0, 20, 0, 20)) = (0.5+0j)
U((20, 0, 20, 0)) = (0.5+0j)
U((20, 20, 20, 20)) = (0.5+0j)
setting to 0
h0_0 size:  (40, 40)
U_0 size:  (40, 40, 40, 40)
Going with Nelec_imp = 1, nbath = 19, Nelec = 20
imp_indices_full = [0, 20]
h0_0 = 
[[-0.25   0.01   0.013 ...  0.     0.     0.   ]
 [ 0.01  -0.947  0.    ...  0.     0.     0.   ]
 [ 0.013  0.    -0.842 ...  0.     0.     0.   ]
 ...
 [ 0.     0.     0.    ...  0.737  0.     0.   ]
 [ 0.     0.     0.    ...  0.     0.842  0.   ]
 [ 0.     0.     0.    ...  0.     0.     0.947]]


--------------------------------------------------------------
Mean-Field Self-Consistent Procedure with block handling
--------------------------------------------------------------
[V1] mfscf proc with Ne=20, maxiter=100, alpha=0.2, threshold=1e-07, spinsym_only = False
[V1] Symmetry analysis found 2 blocks.
[V1] Found 1 unique groups of blocks.
[V1] Blocks: [[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19], [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]]
[V1] Identical Groups (by block index): [[0, 1]]
[V1] iter 0, Tr(rho*h0) = -9.98399815
[V1] Ne = 20, initial tr(rho) = 20.00000000+0.00000000j
[V1] mixing parameter: α = 0.2
[V2] Number of non-zero U elements: 2
[V1] Iter         E_total          E_corr        ΔE_total
[V2] U is sparse, using nzU
[V1]    1     -9.49633670     -0.48766146      1.0095e+03
[V1]   10     -9.64152611     -0.12508484      2.0481e-03
[V1]   20     -9.64883909     -0.12500003      2.1992e-04
[V1]   30     -9.64962432     -0.12500000      2.3614e-05
[V1]   40     -9.64970863     -0.12500000      2.5355e-06
[V1]   50     -9.64971769     -0.12500000      2.7225e-07
[V1] Converged in 55 iterations.
[V1] Final tr(rho) = 20.00000000+0.00000000j
[V2] Reordering final eigenvectors to spin-blocked convention...
hmf = 
[[ 0.     0.01   0.013 ...  0.     0.     0.   ]
 [ 0.01  -0.947  0.    ...  0.     0.     0.   ]
 [ 0.013  0.    -0.842 ...  0.     0.     0.   ]
 ...
 [ 0.     0.     0.    ...  0.737  0.     0.   ]
 [ 0.     0.     0.    ...  0.     0.842  0.   ]
 [ 0.     0.     0.    ...  0.     0.     0.947]]
DEBUG, Nimp_sf = 2
hmf_ab = 
[[ 0.   +0.j  0.   +0.j  0.01 +0.j ...  0.   +0.j  0.01 +0.j  0.   +0.j]
 [ 0.   +0.j  0.   +0.j  0.   +0.j ...  0.013+0.j  0.   +0.j  0.01 +0.j]
 [ 0.01 +0.j  0.   +0.j -0.947+0.j ...  0.   +0.j  0.   +0.j  0.   +0.j]
 ...
 [ 0.   +0.j  0.013+0.j  0.   +0.j ...  0.842+0.j  0.   +0.j  0.   +0.j]
 [ 0.01 +0.j  0.   +0.j  0.   +0.j ...  0.   +0.j  0.947+0.j  0.   +0.j]
 [ 0.   +0.j  0.01 +0.j  0.   +0.j ...  0.   +0.j  0.   +0.j  0.947+0.j]]

--- Analyzed Structure ---
Found 2 blocks
Blocks: [[0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38], [1, 3, 5, 7, 9, 11, 13, 15, 17, 19, 21, 23, 25, 27, 29, 31, 33, 35, 37, 39]]
Identical Groups (by block index): [[0, 1]]
[blocks] 2 blocks; identical groups: [[0, 1]]
[check] Tr rho = 20.000000000000, sum blocks = 20.000000000000, Nelec = 20
[leader block 0] size=20 Nimp_b=1 Nelec_b=10
DEBUG: C1 = 
[[ 1.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.    -0.011  0.111 -0.877  0.264  0.079 -0.218  0.063 -0.093  0.287  0.     0.     0.     0.     0.    -0.    -0.    -0.    -0.    -0.   ]
 [ 0.    -0.015  0.033 -0.331  0.045 -0.17   0.272 -0.505  0.325 -0.597  0.258  0.001  0.    -0.     0.     0.    -0.    -0.     0.    -0.   ]
 [ 0.    -0.02   0.008  0.044  0.085  0.357 -0.494  0.025  0.599 -0.235 -0.453  0.001  0.    -0.     0.     0.    -0.    -0.     0.    -0.   ]
 [ 0.    -0.024 -0.06   0.136  0.04   0.115  0.085 -0.536  0.411  0.684  0.177  0.001  0.    -0.     0.     0.    -0.    -0.     0.    -0.   ]
 [ 0.    -0.03   0.091 -0.017 -0.411 -0.355 -0.507  0.24   0.273  0.038  0.552  0.001  0.    -0.     0.     0.    -0.    -0.     0.    -0.   ]
 [ 0.    -0.039 -0.413 -0.264 -0.741 -0.03  -0.014 -0.236 -0.117  0.046 -0.37   0.002  0.    -0.     0.     0.    -0.    -0.     0.    -0.   ]
 [ 0.    -0.052  0.328 -0.053 -0.371  0.777  0.158  0.064 -0.072 -0.082  0.324  0.003 -0.    -0.     0.     0.    -0.    -0.     0.    -0.   ]
 [ 0.    -0.077 -0.815  0.004  0.236  0.295 -0.132  0.082 -0.07  -0.114  0.381  0.006 -0.    -0.     0.     0.    -0.    -0.001  0.001 -0.001]
 [ 0.    -0.142  0.176  0.168  0.085  0.049 -0.562 -0.566 -0.507 -0.118  0.052  0.015 -0.001 -0.001  0.002  0.001 -0.001 -0.002  0.002 -0.002]
 [ 0.    -0.967  0.034 -0.001  0.024 -0.067  0.105  0.094  0.053  0.021 -0.056  0.158 -0.028 -0.024  0.026  0.02  -0.005 -0.046  0.04  -0.037]
 [ 0.    -0.142  0.004  0.001  0.004 -0.007  0.009  0.008  0.003  0.002 -0.006 -0.436  0.216  0.441 -0.119 -0.109 -0.166  0.467 -0.386  0.358]
 [ 0.    -0.077  0.002  0.001  0.002 -0.003  0.003  0.003  0.001  0.001 -0.002 -0.457  0.522 -0.599 -0.199 -0.154  0.227 -0.086 -0.09  -0.156]
 [ 0.    -0.052  0.001  0.     0.001 -0.002  0.002  0.002  0.     0.    -0.001 -0.351 -0.613  0.035 -0.366 -0.059  0.453 -0.291 -0.068  0.254]
 [ 0.    -0.039  0.001  0.     0.001 -0.001  0.001  0.001 -0.     0.    -0.001 -0.35  -0.172  0.113  0.288 -0.394  0.15   0.375  0.596 -0.279]
 [ 0.    -0.03   0.     0.     0.    -0.001  0.001  0.001 -0.     0.    -0.001 -0.35   0.282  0.319  0.201  0.665  0.165 -0.282  0.32   0.059]
 [ 0.    -0.024  0.     0.     0.    -0.     0.001  0.    -0.     0.    -0.    -0.268 -0.411 -0.436  0.02   0.53  -0.341  0.388 -0.07  -0.121]
 [ 0.    -0.02   0.     0.     0.    -0.     0.     0.    -0.     0.    -0.    -0.252 -0.139 -0.123  0.752 -0.213 -0.166 -0.365 -0.326  0.153]
 [ 0.    -0.015  0.     0.     0.    -0.     0.     0.    -0.     0.    -0.    -0.22  -0.008  0.032 -0.333 -0.193 -0.719 -0.388  0.358  0.08 ]
 [ 0.    -0.011  0.     0.     0.    -0.     0.     0.    -0.     0.    -0.    -0.156 -0.082  0.352 -0.108  0.007 -0.065 -0.182 -0.374 -0.81 ]]
DEBUG: C2 = 
[[1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]]
DEBUG: C3 = 
[[ 0.707 -0.707  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.707  0.707  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     1.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     1.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     1.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     1.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     1.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     1.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     1.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     1.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     1.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     1.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     1.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     1.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     1.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     1.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     1.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     1.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     1.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     1.   ]]
DEBUG: C4 = 
[[ 1.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     1.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.    -0.22  -0.245  0.118  0.162  0.32   0.351  0.449  0.498  0.42   0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.    -0.298  0.523 -0.391  0.64  -0.218 -0.094  0.055  0.113  0.063  0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.    -0.331 -0.158  0.685  0.208 -0.272 -0.519 -0.015  0.098  0.002  0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.399  0.247  0.028 -0.256 -0.438 -0.16   0.691  0.134  0.015  0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.    -0.471 -0.143 -0.203 -0.349 -0.383  0.218 -0.063  0.424 -0.465  0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.    -0.451  0.015 -0.279 -0.467 -0.048 -0.295  0.031 -0.258  0.587  0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.242 -0.722 -0.411  0.298 -0.338 -0.18  -0.014  0.001  0.129  0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.    -0.03  -0.058 -0.275 -0.053  0.565 -0.607  0.212  0.223 -0.367  0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.33   0.192 -0.015 -0.155 -0.039 -0.193 -0.518  0.644  0.329  0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.978 -0.194  0.052 -0.015  0.001  0.016 -0.049  0.028  0.018]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.134  0.305 -0.312  0.146  0.003 -0.227  0.707 -0.399 -0.246]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.002 -0.043 -0.302 -0.056 -0.675  0.541 -0.08  -0.034 -0.385]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.    -0.059 -0.288  0.374  0.402 -0.134 -0.116 -0.263 -0.703 -0.132]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.    -0.039 -0.172  0.357  0.231 -0.427 -0.453  0.241  0.514 -0.279]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.087  0.579  0.387 -0.534 -0.109 -0.192 -0.237 -0.145 -0.309]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.083  0.468  0.027  0.293 -0.476 -0.041 -0.056 -0.025  0.675]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.    -0.035 -0.089  0.6   -0.183 -0.005  0.514  0.54  -0.068  0.191]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.074  0.439  0.176  0.597  0.326  0.365 -0.116  0.232 -0.328]]
DEBUG: C_total = 
[[ 0.707 -0.707  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [-0.008 -0.008  0.224 -0.425  0.524 -0.505  0.394 -0.252  0.13  -0.052  0.014  0.    -0.     0.    -0.     0.    -0.     0.    -0.     0.   ]
 [-0.011 -0.011  0.29  -0.427  0.272  0.075 -0.392  0.509 -0.42   0.239 -0.086  0.001 -0.     0.    -0.     0.    -0.     0.    -0.     0.   ]
 [-0.014 -0.014  0.323 -0.339 -0.029  0.377 -0.316 -0.095  0.459 -0.495  0.271  0.001 -0.     0.    -0.     0.    -0.     0.    -0.     0.   ]
 [-0.017 -0.017  0.344 -0.215 -0.257  0.335  0.123 -0.42   0.085  0.447 -0.508  0.001 -0.     0.    -0.     0.    -0.     0.    -0.     0.   ]
 [-0.022 -0.022  0.357 -0.071 -0.369  0.068  0.392 -0.056 -0.441  0.042  0.61   0.001 -0.     0.    -0.     0.    -0.     0.    -0.     0.   ]
 [-0.028 -0.028  0.364  0.083 -0.345 -0.247  0.236  0.4   -0.013 -0.486 -0.477  0.002 -0.001  0.    -0.     0.    -0.     0.    -0.     0.   ]
 [-0.037 -0.037  0.365  0.239 -0.176 -0.41  -0.221  0.204  0.494  0.466  0.237  0.003 -0.001  0.    -0.     0.    -0.     0.    -0.     0.   ]
 [-0.054 -0.054  0.356  0.388  0.13  -0.222 -0.464 -0.5   -0.375 -0.2   -0.069  0.006 -0.002  0.001 -0.     0.    -0.     0.    -0.     0.   ]
 [-0.1   -0.1    0.321  0.498  0.527  0.449  0.32   0.191  0.094  0.036  0.009  0.014 -0.007  0.003 -0.001  0.    -0.     0.    -0.     0.   ]
 [-0.684 -0.684 -0.14  -0.093 -0.055 -0.03  -0.015 -0.006 -0.002 -0.001 -0.     0.14  -0.093  0.055 -0.03   0.015 -0.006  0.002 -0.001  0.   ]
 [-0.1   -0.1   -0.014 -0.007 -0.003 -0.001 -0.    -0.    -0.    -0.    -0.    -0.321  0.498 -0.527  0.449 -0.32   0.191 -0.094  0.036 -0.009]
 [-0.054 -0.054 -0.006 -0.002 -0.001 -0.    -0.    -0.    -0.    -0.    -0.    -0.356  0.388 -0.13  -0.222  0.464 -0.5    0.375 -0.2    0.069]
 [-0.037 -0.037 -0.003 -0.001 -0.    -0.    -0.    -0.    -0.    -0.    -0.    -0.365  0.239  0.176 -0.41   0.221  0.204 -0.494  0.466 -0.237]
 [-0.028 -0.028 -0.002 -0.001 -0.    -0.    -0.    -0.    -0.    -0.    -0.    -0.364  0.083  0.345 -0.247 -0.236  0.4    0.013 -0.486  0.477]
 [-0.022 -0.022 -0.001 -0.    -0.    -0.    -0.    -0.    -0.    -0.    -0.    -0.357 -0.071  0.369  0.068 -0.392 -0.056  0.441  0.042 -0.61 ]
 [-0.017 -0.017 -0.001 -0.    -0.    -0.    -0.    -0.    -0.    -0.    -0.    -0.344 -0.215  0.257  0.335 -0.123 -0.42  -0.085  0.447  0.508]
 [-0.014 -0.014 -0.001 -0.    -0.    -0.    -0.    -0.    -0.    -0.    -0.    -0.323 -0.339  0.029  0.377  0.316 -0.095 -0.459 -0.495 -0.271]
 [-0.011 -0.011 -0.001 -0.    -0.    -0.    -0.    -0.    -0.    -0.    -0.    -0.29  -0.427 -0.272  0.075  0.392  0.509  0.42   0.239  0.086]
 [-0.008 -0.008 -0.    -0.    -0.    -0.    -0.    -0.    -0.    -0.    -0.    -0.224 -0.425 -0.524 -0.505 -0.394 -0.252 -0.13  -0.052 -0.014]]
DEBUG: C_total_restored = 
[[ 1.    -0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [-0.    -0.011  0.224 -0.425  0.524 -0.505  0.394 -0.252  0.13  -0.052  0.014  0.    -0.     0.    -0.     0.    -0.     0.    -0.     0.   ]
 [ 0.    -0.015  0.29  -0.427  0.272  0.075 -0.392  0.509 -0.42   0.239 -0.086  0.001 -0.     0.    -0.     0.    -0.     0.    -0.     0.   ]
 [-0.    -0.02   0.323 -0.339 -0.029  0.377 -0.316 -0.095  0.459 -0.495  0.271  0.001 -0.     0.    -0.     0.    -0.     0.    -0.     0.   ]
 [-0.    -0.024  0.344 -0.215 -0.257  0.335  0.123 -0.42   0.085  0.447 -0.508  0.001 -0.     0.    -0.     0.    -0.     0.    -0.     0.   ]
 [ 0.    -0.03   0.357 -0.071 -0.369  0.068  0.392 -0.056 -0.441  0.042  0.61   0.001 -0.     0.    -0.     0.    -0.     0.    -0.     0.   ]
 [-0.    -0.039  0.364  0.083 -0.345 -0.247  0.236  0.4   -0.013 -0.486 -0.477  0.002 -0.001  0.    -0.     0.    -0.     0.    -0.     0.   ]
 [-0.    -0.052  0.365  0.239 -0.176 -0.41  -0.221  0.204  0.494  0.466  0.237  0.003 -0.001  0.    -0.     0.    -0.     0.    -0.     0.   ]
 [ 0.    -0.077  0.356  0.388  0.13  -0.222 -0.464 -0.5   -0.375 -0.2   -0.069  0.006 -0.002  0.001 -0.     0.    -0.     0.    -0.     0.   ]
 [ 0.    -0.142  0.321  0.498  0.527  0.449  0.32   0.191  0.094  0.036  0.009  0.014 -0.007  0.003 -0.001  0.    -0.     0.    -0.     0.   ]
 [ 0.    -0.967 -0.14  -0.093 -0.055 -0.03  -0.015 -0.006 -0.002 -0.001 -0.     0.14  -0.093  0.055 -0.03   0.015 -0.006  0.002 -0.001  0.   ]
 [ 0.    -0.142 -0.014 -0.007 -0.003 -0.001 -0.    -0.    -0.    -0.    -0.    -0.321  0.498 -0.527  0.449 -0.32   0.191 -0.094  0.036 -0.009]
 [-0.    -0.077 -0.006 -0.002 -0.001 -0.    -0.    -0.    -0.    -0.    -0.    -0.356  0.388 -0.13  -0.222  0.464 -0.5    0.375 -0.2    0.069]
 [ 0.    -0.052 -0.003 -0.001 -0.    -0.    -0.    -0.    -0.    -0.    -0.    -0.365  0.239  0.176 -0.41   0.221  0.204 -0.494  0.466 -0.237]
 [-0.    -0.039 -0.002 -0.001 -0.    -0.    -0.    -0.    -0.    -0.    -0.    -0.364  0.083  0.345 -0.247 -0.236  0.4    0.013 -0.486  0.477]
 [-0.    -0.03  -0.001 -0.    -0.    -0.    -0.    -0.    -0.    -0.    -0.    -0.357 -0.071  0.369  0.068 -0.392 -0.056  0.441  0.042 -0.61 ]
 [-0.    -0.024 -0.001 -0.    -0.    -0.    -0.    -0.    -0.    -0.    -0.    -0.344 -0.215  0.257  0.335 -0.123 -0.42  -0.085  0.447  0.508]
 [ 0.    -0.02  -0.001 -0.    -0.    -0.    -0.    -0.    -0.    -0.    -0.    -0.323 -0.339  0.029  0.377  0.316 -0.095 -0.459 -0.495 -0.271]
 [-0.    -0.015 -0.001 -0.    -0.    -0.    -0.    -0.    -0.    -0.    -0.    -0.29  -0.427 -0.272  0.075  0.392  0.509  0.42   0.239  0.086]
 [ 0.    -0.011 -0.    -0.    -0.    -0.    -0.    -0.    -0.    -0.    -0.    -0.224 -0.425 -0.524 -0.505 -0.394 -0.252 -0.13  -0.052 -0.014]]
h_block_final:
[[ 0.    -0.032  0.045 -0.    -0.    -0.    -0.     0.    -0.     0.    -0.    -0.045 -0.    -0.    -0.    -0.     0.     0.    -0.    -0.   ]
 [-0.032 -0.     0.045  0.     0.     0.     0.    -0.     0.    -0.     0.     0.045 -0.    -0.    -0.    -0.     0.     0.    -0.    -0.   ]
 [ 0.045  0.045 -0.473  0.249  0.    -0.     0.     0.    -0.    -0.     0.     0.     0.    -0.     0.     0.     0.    -0.    -0.    -0.   ]
 [-0.     0.     0.249 -0.52   0.24   0.     0.    -0.     0.    -0.     0.     0.     0.     0.    -0.    -0.     0.    -0.     0.     0.   ]
 [-0.     0.     0.     0.24  -0.53   0.232 -0.     0.    -0.    -0.     0.     0.    -0.    -0.     0.     0.    -0.     0.    -0.    -0.   ]
 [-0.     0.    -0.     0.     0.232 -0.534  0.22  -0.    -0.     0.     0.    -0.    -0.    -0.    -0.     0.     0.     0.     0.    -0.   ]
 [-0.     0.     0.     0.    -0.     0.22  -0.536  0.204  0.     0.    -0.     0.     0.     0.    -0.    -0.    -0.    -0.     0.     0.   ]
 [ 0.    -0.     0.    -0.     0.    -0.     0.204 -0.535  0.182 -0.     0.    -0.    -0.    -0.    -0.     0.     0.     0.    -0.    -0.   ]
 [-0.     0.    -0.     0.    -0.    -0.     0.     0.182 -0.535  0.153 -0.     0.     0.    -0.     0.    -0.    -0.    -0.    -0.    -0.   ]
 [ 0.    -0.    -0.    -0.    -0.     0.     0.    -0.     0.153 -0.534  0.111 -0.    -0.     0.     0.    -0.    -0.    -0.     0.     0.   ]
 [-0.     0.     0.     0.     0.     0.    -0.     0.    -0.     0.111 -0.534 -0.    -0.    -0.     0.    -0.     0.     0.    -0.     0.   ]
 [-0.045  0.045  0.     0.     0.    -0.     0.    -0.     0.    -0.    -0.     0.473  0.249  0.     0.     0.     0.     0.    -0.    -0.   ]
 [-0.    -0.     0.     0.    -0.    -0.     0.    -0.     0.    -0.    -0.     0.249  0.52   0.24  -0.     0.     0.    -0.     0.    -0.   ]
 [-0.    -0.    -0.     0.    -0.    -0.     0.    -0.    -0.     0.    -0.     0.     0.24   0.53   0.232 -0.    -0.     0.     0.     0.   ]
 [-0.    -0.     0.    -0.     0.    -0.    -0.    -0.     0.     0.     0.     0.    -0.     0.232  0.534  0.22   0.    -0.    -0.    -0.   ]
 [-0.    -0.     0.    -0.     0.     0.    -0.     0.    -0.    -0.    -0.     0.     0.    -0.     0.22   0.536  0.204 -0.    -0.     0.   ]
 [ 0.     0.     0.     0.    -0.     0.    -0.     0.    -0.    -0.     0.     0.     0.    -0.     0.     0.204  0.535  0.182 -0.    -0.   ]
 [ 0.     0.    -0.    -0.     0.     0.    -0.     0.    -0.    -0.     0.     0.    -0.     0.    -0.    -0.     0.182  0.535  0.153  0.   ]
 [-0.    -0.    -0.     0.    -0.     0.     0.    -0.    -0.     0.    -0.    -0.     0.     0.    -0.     0.    -0.     0.153  0.534  0.111]
 [-0.    -0.    -0.     0.    -0.    -0.     0.    -0.    -0.     0.     0.    -0.    -0.     0.    -0.     0.    -0.     0.     0.111  0.534]]
C_block:
[[ 1.    -0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [-0.    -0.011  0.224 -0.425  0.524 -0.505  0.394 -0.252  0.13  -0.052  0.014  0.    -0.     0.    -0.     0.    -0.     0.    -0.     0.   ]
 [ 0.    -0.015  0.29  -0.427  0.272  0.075 -0.392  0.509 -0.42   0.239 -0.086  0.001 -0.     0.    -0.     0.    -0.     0.    -0.     0.   ]
 [-0.    -0.02   0.323 -0.339 -0.029  0.377 -0.316 -0.095  0.459 -0.495  0.271  0.001 -0.     0.    -0.     0.    -0.     0.    -0.     0.   ]
 [-0.    -0.024  0.344 -0.215 -0.257  0.335  0.123 -0.42   0.085  0.447 -0.508  0.001 -0.     0.    -0.     0.    -0.     0.    -0.     0.   ]
 [ 0.    -0.03   0.357 -0.071 -0.369  0.068  0.392 -0.056 -0.441  0.042  0.61   0.001 -0.     0.    -0.     0.    -0.     0.    -0.     0.   ]
 [-0.    -0.039  0.364  0.083 -0.345 -0.247  0.236  0.4   -0.013 -0.486 -0.477  0.002 -0.001  0.    -0.     0.    -0.     0.    -0.     0.   ]
 [-0.    -0.052  0.365  0.239 -0.176 -0.41  -0.221  0.204  0.494  0.466  0.237  0.003 -0.001  0.    -0.     0.    -0.     0.    -0.     0.   ]
 [ 0.    -0.077  0.356  0.388  0.13  -0.222 -0.464 -0.5   -0.375 -0.2   -0.069  0.006 -0.002  0.001 -0.     0.    -0.     0.    -0.     0.   ]
 [ 0.    -0.142  0.321  0.498  0.527  0.449  0.32   0.191  0.094  0.036  0.009  0.014 -0.007  0.003 -0.001  0.    -0.     0.    -0.     0.   ]
 [ 0.    -0.967 -0.14  -0.093 -0.055 -0.03  -0.015 -0.006 -0.002 -0.001 -0.     0.14  -0.093  0.055 -0.03   0.015 -0.006  0.002 -0.001  0.   ]
 [ 0.    -0.142 -0.014 -0.007 -0.003 -0.001 -0.    -0.    -0.    -0.    -0.    -0.321  0.498 -0.527  0.449 -0.32   0.191 -0.094  0.036 -0.009]
 [-0.    -0.077 -0.006 -0.002 -0.001 -0.    -0.    -0.    -0.    -0.    -0.    -0.356  0.388 -0.13  -0.222  0.464 -0.5    0.375 -0.2    0.069]
 [ 0.    -0.052 -0.003 -0.001 -0.    -0.    -0.    -0.    -0.    -0.    -0.    -0.365  0.239  0.176 -0.41   0.221  0.204 -0.494  0.466 -0.237]
 [-0.    -0.039 -0.002 -0.001 -0.    -0.    -0.    -0.    -0.    -0.    -0.    -0.364  0.083  0.345 -0.247 -0.236  0.4    0.013 -0.486  0.477]
 [-0.    -0.03  -0.001 -0.    -0.    -0.    -0.    -0.    -0.    -0.    -0.    -0.357 -0.071  0.369  0.068 -0.392 -0.056  0.441  0.042 -0.61 ]
 [-0.    -0.024 -0.001 -0.    -0.    -0.    -0.    -0.    -0.    -0.    -0.    -0.344 -0.215  0.257  0.335 -0.123 -0.42  -0.085  0.447  0.508]
 [ 0.    -0.02  -0.001 -0.    -0.    -0.    -0.    -0.    -0.    -0.    -0.    -0.323 -0.339  0.029  0.377  0.316 -0.095 -0.459 -0.495 -0.271]
 [-0.    -0.015 -0.001 -0.    -0.    -0.    -0.    -0.    -0.    -0.    -0.    -0.29  -0.427 -0.272  0.075  0.392  0.509  0.42   0.239  0.086]
 [ 0.    -0.011 -0.    -0.    -0.    -0.    -0.    -0.    -0.    -0.    -0.    -0.224 -0.425 -0.524 -0.505 -0.394 -0.252 -0.13  -0.052 -0.014]]
[sanity] ||h_final - C^† h C|| / ||h|| = 0.000e+00
hdc_ab = 
[[ 0.     0.    -0.032 ...  0.    -0.     0.   ]
 [ 0.     0.     0.    ... -0.     0.    -0.   ]
 [-0.032  0.    -0.    ...  0.    -0.     0.   ]
 ...
 [ 0.    -0.     0.    ...  0.534  0.     0.111]
 [-0.     0.    -0.    ...  0.     0.534  0.   ]
 [ 0.    -0.     0.    ...  0.111  0.     0.534]]
C_ab = 
[[ 1.     0.    -0.    ...  0.     0.     0.   ]
 [ 0.     1.     0.    ...  0.     0.     0.   ]
 [-0.     0.    -0.011 ...  0.     0.     0.   ]
 ...
 [ 0.    -0.     0.    ...  0.239  0.     0.086]
 [ 0.     0.    -0.011 ...  0.    -0.014  0.   ]
 [ 0.     0.     0.    ... -0.052  0.    -0.014]]
C = 
[[ 1.    -0.     0.    ...  0.     0.     0.   ]
 [-0.    -0.011  0.224 ...  0.     0.     0.   ]
 [ 0.    -0.015  0.29  ...  0.     0.     0.   ]
 ...
 [ 0.     0.     0.    ... -0.459 -0.495 -0.271]
 [ 0.     0.     0.    ...  0.42   0.239  0.086]
 [ 0.     0.     0.    ... -0.13  -0.052 -0.014]]
******************************************
h0_0 = 
[[-0.25  -0.032  0.045 ...  0.     0.     0.   ]
 [-0.032 -0.     0.045 ...  0.     0.     0.   ]
 [ 0.045  0.045 -0.473 ...  0.     0.     0.   ]
 ...
 [ 0.     0.     0.    ...  0.535  0.153  0.   ]
 [ 0.     0.     0.    ...  0.153  0.534  0.111]
 [ 0.     0.     0.    ...  0.     0.111  0.534]]
h0_legacy = 
[[-0.25   0.01   0.013 ...  0.     0.     0.   ]
 [ 0.01  -0.947  0.    ...  0.     0.     0.   ]
 [ 0.013  0.    -0.842 ...  0.     0.     0.   ]
 ...
 [ 0.     0.     0.    ...  0.737  0.     0.   ]
 [ 0.     0.     0.    ...  0.     0.842  0.   ]
 [ 0.     0.     0.    ...  0.     0.     0.947]]
Partitioning system: 1 impurity orbitals, 19 bath orbitals.
Generating basis for 1 electrons on impurity and 19 on bath.
Found 2 impurity configurations and 2 bath configurations.
Retaining only Sz=0 in starting basis
Generated a total of 2 unique starting determinants.
sb = [<SlaterDeterminant α=[0, 2, 3, 4, 5, 6, 7, 8, 9, 10] β=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10]>, <SlaterDeterminant α=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10] β=[0, 2, 3, 4, 5, 6, 7, 8, 9, 10]>]
DEBUG: entering selective_ci()
DEBUG: constructing tables
DEBUG: tables constructed
DEBUG: build ham time = 0.00013017654418945312
[init] dim=2  E0=-9.710870033809
blocks = [0.0], time block = 3.886222839355469e-05
apply_ham time = 6.699562072753906e-05
gen basis time = 0.00011587142944335938
sel basis time = 5.984306335449219e-05
Found 1 S_z blocks: [0.0]
  Processing Sz=0.0 block of size 12x12
DEBUG: build ham time = 0.0001728534698486328
DEBUG: finished rearranging vectors
DEBUG: for basis size 12, ham diag time = 0.0004680156707763672
[iter 0] dim=    12  Es=[-9.733678655045 -9.725256826556]  |dE0|=2.281e-02
blocks = [0.0], time block = 1.52587890625e-05
apply_ham time = 0.0001010894775390625
gen basis time = 0.0001499652862548828
sel basis time = 7.915496826171875e-05
Found 1 S_z blocks: [0.0]
  Processing Sz=0.0 block of size 32x32
DEBUG: build ham time = 0.00013113021850585938
DEBUG: finished rearranging vectors
DEBUG: for basis size 32, ham diag time = 0.0004317760467529297
[iter 1] dim=    32  Es=[-9.735739217128 -9.729194518036]  |dE0|=2.061e-03
blocks = [0.0], time block = 3.075599670410156e-05
apply_ham time = 0.00024318695068359375
gen basis time = 0.00034117698669433594
sel basis time = 0.00013494491577148438
Found 1 S_z blocks: [0.0]
  Processing Sz=0.0 block of size 72x72
DEBUG: build ham time = 0.0002338886260986328
DEBUG: finished rearranging vectors
DEBUG: for basis size 72, ham diag time = 0.008852958679199219
[iter 2] dim=    72  Es=[-9.736480799767 -9.730606831003]  |dE0|=7.416e-04
blocks = [0.0], time block = 7.510185241699219e-05
apply_ham time = 0.0005791187286376953
gen basis time = 0.0008041858673095703
sel basis time = 0.0002720355987548828
Found 1 S_z blocks: [0.0]
  Processing Sz=0.0 block of size 152x152
DEBUG: build ham time = 0.0004889965057373047
DEBUG: finished rearranging vectors
DEBUG: for basis size 152, ham diag time = 0.14200091361999512
[iter 3] dim=   152  Es=[-9.736759374965 -9.731133224780]  |dE0|=2.786e-04
blocks = [0.0], time block = 0.00015497207641601562
apply_ham time = 0.00127410888671875
gen basis time = 0.0017049312591552734
sel basis time = 0.0004930496215820312
Found 1 S_z blocks: [0.0]
  Processing Sz=0.0 block of size 296x296
DEBUG: build ham time = 0.0009453296661376953
DEBUG: finished rearranging vectors
DEBUG: for basis size 296, ham diag time = 0.023113250732421875
[iter 4] dim=   296  Es=[-9.736856496304 -9.731314153144]  |dE0|=9.712e-05
blocks = [0.0], time block = 0.000286102294921875
apply_ham time = 0.0024862289428710938
gen basis time = 0.0032770633697509766
sel basis time = 0.0008368492126464844
Found 1 S_z blocks: [0.0]
  Processing Sz=0.0 block of size 542x542
DEBUG: build ham time = 0.0016977787017822266
DEBUG: finished rearranging vectors
DEBUG: for basis size 542, ham diag time = 0.0941460132598877
[iter 5] dim=   542  Es=[-9.736886886393 -9.731368842164]  |dE0|=3.039e-05
blocks = [0.0], time block = 0.0005130767822265625
apply_ham time = 0.004650115966796875
gen basis time = 0.006047964096069336
sel basis time = 0.001476287841796875
Found 1 S_z blocks: [0.0]
  Processing Sz=0.0 block of size 934x934
DEBUG: build ham time = 0.002859830856323242
DEBUG: finished rearranging vectors
DEBUG: for basis size 934, ham diag time = 0.0639801025390625
[iter 6] dim=   934  Es=[-9.736895596966 -9.731383541808]  |dE0|=8.711e-06
[conv] reached |dE| < 1e-05
Found 1 S_z blocks: [0.0]
  Processing Sz=0.0 block of size 934x934
DEBUG: build ham time = 0.0030527114868164062
DEBUG: finished rearranging vectors
sci total time : 0.8235349655151367
energies = [-9.737 -9.731], e0 = -9.736895596965978
len basis = 934
len(basis(psis0)) = 934
rdm : 
[[ 0.5  +0.j  0.158+0.j -0.018+0.j ...  0.   +0.j  0.   +0.j  0.   +0.j]
 [ 0.158+0.j  0.5  +0.j -0.05 +0.j ...  0.   +0.j  0.   +0.j  0.   +0.j]
 [-0.018+0.j -0.05 +0.j  0.992+0.j ...  0.   +0.j  0.   +0.j  0.   +0.j]
 ...
 [ 0.   +0.j  0.   +0.j  0.   +0.j ...  0.   +0.j  0.   +0.j  0.   +0.j]
 [ 0.   +0.j  0.   +0.j  0.   +0.j ...  0.   +0.j  0.   +0.j  0.   +0.j]
 [ 0.   +0.j  0.   +0.j  0.   +0.j ...  0.   +0.j  0.   +0.j  0.   +0.j]]
impurity occupation: (1.0000000000006368+0j)
total occupation : (19.9999999999999+0j)
target_indices = [0, 20]
 Founds blocks : [[0], [1]]
  Symmetry: is_diagonal=True. Found 1 unique group(s) of blocks.
  Computing representative g_(0,0) via Scalar CF...
DEBUG: build ham time = 0.01785874366760254
DEBUG: build ham time = 0.01717376708984375

Thermally-averaged calculation finished.
Data saved to 'dump/A_19'
