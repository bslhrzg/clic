******************************************
******************************************
NF = 24, M = 12, Nimp = 2
******************************************
[[-0.75   0.     0.     0.     0.087  0.     0.108  0.     0.113  0.     0.108  0.     0.087  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.    -0.75   0.     0.     0.     0.087  0.     0.108  0.     0.113  0.     0.108  0.     0.087  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.    -0.75   0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.087  0.     0.108  0.     0.113  0.     0.108  0.     0.087  0.   ]
 [ 0.     0.     0.    -0.75   0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.087  0.     0.108  0.     0.113  0.     0.108  0.     0.087]
 [ 0.087  0.     0.     0.    -0.8   -0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.087  0.     0.    -0.    -0.8    0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.108  0.     0.     0.     0.     0.    -0.4   -0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.108  0.     0.     0.     0.    -0.    -0.4    0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.113  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.113  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.108  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.4    0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.108  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.4    0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.087  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.8    0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.087  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.8    0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.087  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.    -0.8   -0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.087  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.    -0.    -0.8    0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.108  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.    -0.4   -0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.108  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.    -0.    -0.4    0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.113  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.113  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.108  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.4    0.     0.     0.   ]
 [ 0.     0.     0.     0.108  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.4    0.     0.   ]
 [ 0.     0.     0.087  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.8    0.   ]
 [ 0.     0.     0.     0.087  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.8  ]]
************
[[-0.75   0.     0.087  0.108  0.113  0.108  0.087  0.     0.     0.     0.     0.   ]
 [ 0.    -0.75   0.     0.     0.     0.     0.     0.087  0.108  0.113  0.108  0.087]
 [ 0.087  0.    -0.8    0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.108  0.     0.    -0.4    0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.113  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.108  0.     0.     0.     0.     0.4    0.     0.     0.     0.     0.     0.   ]
 [ 0.087  0.     0.     0.     0.     0.     0.8    0.     0.     0.     0.     0.   ]
 [ 0.     0.087  0.     0.     0.     0.     0.    -0.8    0.     0.     0.     0.   ]
 [ 0.     0.108  0.     0.     0.     0.     0.     0.    -0.4    0.     0.     0.   ]
 [ 0.     0.113  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.108  0.     0.     0.     0.     0.     0.     0.     0.     0.4    0.   ]
 [ 0.     0.087  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.8  ]]
U((0, 0, 0, 0)) = (0.5+0j)
setting to 0
U((0, 1, 0, 1)) = (0.5+0j)
U((0, 12, 0, 12)) = (0.5+0j)
U((0, 13, 0, 13)) = (0.5+0j)
U((1, 0, 1, 0)) = (0.5+0j)
U((1, 1, 1, 1)) = (0.5+0j)
setting to 0
U((1, 12, 1, 12)) = (0.5+0j)
U((1, 13, 1, 13)) = (0.5+0j)
U((12, 0, 12, 0)) = (0.5+0j)
U((12, 1, 12, 1)) = (0.5+0j)
U((12, 12, 12, 12)) = (0.5+0j)
setting to 0
U((12, 13, 12, 13)) = (0.5+0j)
U((13, 0, 13, 0)) = (0.5+0j)
U((13, 1, 13, 1)) = (0.5+0j)
U((13, 12, 13, 12)) = (0.5+0j)
U((13, 13, 13, 13)) = (0.5+0j)
setting to 0
h0_0 size:  (24, 24)
U_0 size:  (24, 24, 24, 24)
Going with Nelec_imp = 2, nbath = 10, Nelec = 12
imp_indices_full = [0, 1, 12, 13]
h0_0 = 
[[-0.75   0.     0.087  0.108  0.113  0.108  0.087  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.    -0.75   0.     0.     0.     0.     0.     0.087  0.108  0.113  0.108  0.087  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.087  0.    -0.8    0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.    -0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.108  0.     0.    -0.4    0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.    -0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.113  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.108  0.     0.     0.     0.     0.4    0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.087  0.     0.     0.     0.     0.     0.8    0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.087  0.     0.     0.     0.     0.    -0.8    0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.    -0.     0.     0.     0.     0.   ]
 [ 0.     0.108  0.     0.     0.     0.     0.     0.    -0.4    0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.    -0.     0.     0.     0.   ]
 [ 0.     0.113  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.108  0.     0.     0.     0.     0.     0.     0.     0.     0.4    0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.087  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.8    0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.    -0.75   0.     0.087  0.108  0.113  0.108  0.087  0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.    -0.75   0.     0.     0.     0.     0.     0.087  0.108  0.113  0.108  0.087]
 [ 0.     0.    -0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.087  0.    -0.8    0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.    -0.     0.     0.     0.     0.     0.     0.     0.     0.     0.108  0.     0.    -0.4    0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.113  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.108  0.     0.     0.     0.     0.4    0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.087  0.     0.     0.     0.     0.     0.8    0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.    -0.     0.     0.     0.     0.     0.     0.087  0.     0.     0.     0.     0.    -0.8    0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.    -0.     0.     0.     0.     0.     0.108  0.     0.     0.     0.     0.     0.    -0.4    0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.113  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.108  0.     0.     0.     0.     0.     0.     0.     0.     0.4    0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.087  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.8  ]]


--------------------------------------------------------------
Mean-Field Self-Consistent Procedure with block handling
--------------------------------------------------------------
[V1] mfscf proc with Ne=12, maxiter=100, alpha=0.2, threshold=1e-07, spinsym_only = False
[V1] Symmetry analysis found 4 blocks.
[V1] Found 1 unique groups of blocks.
[V1] Blocks: [[0, 2, 3, 4, 5, 6], [1, 7, 8, 9, 10, 11], [12, 14, 15, 16, 17, 18], [13, 19, 20, 21, 22, 23]]
[V1] Identical Groups (by block index): [[0, 1, 2, 3]]
[V1] iter 0, Tr(rho*h0) = -5.57387740
[V1] Ne = 12, initial tr(rho) = 12.00000000+0.00000000j
[V1] mixing parameter: α = 0.2
[V2] Number of non-zero U elements: 12
[V1] Iter         E_total          E_corr        ΔE_total
[V2] U is sparse, using nzU
[V1]    1     -2.94006869     -2.63380871      1.0029e+03
[V1]   10     -4.15361235     -0.54118169      2.3719e-02
[V1]   20     -4.23827079     -0.53751293      2.5458e-03
[V1]   30     -4.24736062     -0.53751005      2.7335e-04
[V1]   40     -4.24833663     -0.53751005      2.9351e-05
[V1]   50     -4.24844143     -0.53751005      3.1516e-06
[V1]   60     -4.24845268     -0.53751005      3.3840e-07
[V1] Converged in 66 iterations.
[V1] Final tr(rho) = 12.00000000+0.00000000j
[V2] Reordering final eigenvectors to spin-blocked convention...
hmf = 
[[-0.115  0.     0.087  0.108  0.113  0.108  0.087  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.    -0.115  0.     0.     0.     0.     0.     0.087  0.108  0.113  0.108  0.087  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.087  0.    -0.8    0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.108  0.     0.    -0.4    0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.113  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.108  0.     0.     0.     0.     0.4    0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.087  0.     0.     0.     0.     0.     0.8    0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.087  0.     0.     0.     0.     0.    -0.8    0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.108  0.     0.     0.     0.     0.     0.    -0.4    0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.113  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.108  0.     0.     0.     0.     0.     0.     0.     0.     0.4    0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.087  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.8    0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.    -0.115  0.     0.087  0.108  0.113  0.108  0.087  0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.    -0.115  0.     0.     0.     0.     0.     0.087  0.108  0.113  0.108  0.087]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.087  0.    -0.8    0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.108  0.     0.    -0.4    0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.113  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.108  0.     0.     0.     0.     0.4    0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.087  0.     0.     0.     0.     0.     0.8    0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.087  0.     0.     0.     0.     0.    -0.8    0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.108  0.     0.     0.     0.     0.     0.    -0.4    0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.113  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.108  0.     0.     0.     0.     0.     0.     0.     0.     0.4    0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.087  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.8  ]]
DEBUG, Nimp_sf = 4
hmf_ab = 
[[-0.115+0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.087+0.j  0.   +0.j  0.108+0.j  0.   +0.j  0.113+0.j  0.   +0.j  0.108+0.j  0.   +0.j  0.087+0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j]
 [ 0.   +0.j -0.115+0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.087+0.j  0.   +0.j  0.108+0.j  0.   +0.j  0.113+0.j  0.   +0.j  0.108+0.j  0.   +0.j  0.087+0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j]
 [ 0.   +0.j  0.   +0.j -0.115+0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.087+0.j  0.   +0.j  0.108+0.j  0.   +0.j  0.113+0.j  0.   +0.j  0.108+0.j  0.   +0.j  0.087+0.j  0.   +0.j]
 [ 0.   +0.j  0.   +0.j  0.   +0.j -0.115+0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.087+0.j  0.   +0.j  0.108+0.j  0.   +0.j  0.113+0.j  0.   +0.j  0.108+0.j  0.   +0.j  0.087+0.j]
 [ 0.087+0.j  0.   +0.j  0.   +0.j  0.   +0.j -0.8  +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j]
 [ 0.   +0.j  0.087+0.j  0.   +0.j  0.   +0.j  0.   +0.j -0.8  +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j]
 [ 0.108+0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j -0.4  +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j]
 [ 0.   +0.j  0.108+0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j -0.4  +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j]
 [ 0.113+0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j]
 [ 0.   +0.j  0.113+0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j]
 [ 0.108+0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.4  +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j]
 [ 0.   +0.j  0.108+0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.4  +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j]
 [ 0.087+0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.8  +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j]
 [ 0.   +0.j  0.087+0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.8  +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j]
 [ 0.   +0.j  0.   +0.j  0.087+0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j -0.8  +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j]
 [ 0.   +0.j  0.   +0.j  0.   +0.j  0.087+0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j -0.8  +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j]
 [ 0.   +0.j  0.   +0.j  0.108+0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j -0.4  +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j]
 [ 0.   +0.j  0.   +0.j  0.   +0.j  0.108+0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j -0.4  +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j]
 [ 0.   +0.j  0.   +0.j  0.113+0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j]
 [ 0.   +0.j  0.   +0.j  0.   +0.j  0.113+0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j]
 [ 0.   +0.j  0.   +0.j  0.108+0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.4  +0.j  0.   +0.j  0.   +0.j  0.   +0.j]
 [ 0.   +0.j  0.   +0.j  0.   +0.j  0.108+0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.4  +0.j  0.   +0.j  0.   +0.j]
 [ 0.   +0.j  0.   +0.j  0.087+0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.8  +0.j  0.   +0.j]
 [ 0.   +0.j  0.   +0.j  0.   +0.j  0.087+0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.8  +0.j]]

--- Analyzed Structure ---
Found 4 blocks
Blocks: [[0, 4, 6, 8, 10, 12], [1, 5, 7, 9, 11, 13], [2, 14, 16, 18, 20, 22], [3, 15, 17, 19, 21, 23]]
Identical Groups (by block index): [[0, 1, 2, 3]]
[blocks] 4 blocks; identical groups: [[0, 1, 2, 3]]
[check] Tr rho = 12.000000000000, sum blocks = 12.000000000000, Nelec = 12
[leader block 0] size=6 Nimp_b=1 Nelec_b=3
DEBUG: C1 = 
[[ 1.     0.     0.     0.     0.     0.   ]
 [ 0.    -0.062  0.88   0.47  -0.007  0.   ]
 [ 0.    -0.138 -0.474  0.869 -0.023 -0.   ]
 [ 0.    -0.94   0.012 -0.151 -0.303 -0.045]
 [ 0.    -0.276 -0.001 -0.023  0.784  0.556]
 [ 0.    -0.133 -0.001 -0.008  0.541 -0.83 ]]
DEBUG: C2 = 
[[1. 0. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0. 0.]
 [0. 0. 0. 1. 0. 0.]
 [0. 0. 0. 0. 1. 0.]
 [0. 0. 0. 0. 0. 1.]]
DEBUG: C3 = 
[[-0.838  0.545  0.     0.     0.     0.   ]
 [-0.545 -0.838  0.     0.     0.     0.   ]
 [ 0.     0.     1.     0.     0.     0.   ]
 [ 0.     0.     0.     1.     0.     0.   ]
 [ 0.     0.     0.     0.     1.     0.   ]
 [ 0.     0.     0.     0.     0.     1.   ]]
DEBUG: C4 = 
[[ 1.     0.     0.     0.     0.     0.   ]
 [ 0.     1.     0.     0.     0.     0.   ]
 [ 0.     0.    -0.228  0.974  0.     0.   ]
 [ 0.     0.    -0.974 -0.228  0.     0.   ]
 [ 0.     0.     0.     0.     0.983 -0.183]
 [ 0.     0.     0.     0.    -0.183 -0.983]]
DEBUG: C_total = 
[[-0.838  0.545  0.     0.     0.     0.   ]
 [ 0.034  0.052 -0.659  0.75  -0.007  0.001]
 [ 0.075  0.116 -0.738 -0.66  -0.022  0.005]
 [ 0.512  0.788  0.144  0.046 -0.289  0.1  ]
 [ 0.15   0.231  0.023  0.004  0.669 -0.69 ]
 [ 0.073  0.112  0.008  0.001  0.684  0.717]]
DEBUG: C_total_restored = 
[[ 1.    -0.     0.     0.     0.     0.   ]
 [ 0.    -0.062 -0.659  0.75  -0.007  0.001]
 [ 0.    -0.138 -0.738 -0.66  -0.022  0.005]
 [ 0.    -0.94   0.144  0.046 -0.289  0.1  ]
 [-0.    -0.276  0.023  0.004  0.669 -0.69 ]
 [-0.    -0.133  0.008  0.001  0.684  0.717]]
h_block_final:
[[-0.115 -0.168 -0.118  0.     0.096 -0.   ]
 [-0.168  0.034 -0.077 -0.    -0.148 -0.   ]
 [-0.118 -0.077 -0.565  0.2   -0.    -0.   ]
 [ 0.    -0.     0.2   -0.624  0.     0.   ]
 [ 0.096 -0.148 -0.     0.     0.553  0.208]
 [-0.    -0.    -0.     0.     0.208  0.602]]
C_block:
[[ 1.    -0.     0.     0.     0.     0.   ]
 [ 0.    -0.062 -0.659  0.75  -0.007  0.001]
 [ 0.    -0.138 -0.738 -0.66  -0.022  0.005]
 [ 0.    -0.94   0.144  0.046 -0.289  0.1  ]
 [-0.    -0.276  0.023  0.004  0.669 -0.69 ]
 [-0.    -0.133  0.008  0.001  0.684  0.717]]
[sanity] ||h_final - C^† h C|| / ||h|| = 0.000e+00
hdc_ab = 
[[-0.115  0.     0.     0.    -0.168  0.    -0.118  0.     0.     0.     0.096  0.    -0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.    -0.115  0.     0.     0.    -0.168  0.    -0.118  0.     0.     0.     0.096  0.    -0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.    -0.115  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.    -0.168  0.    -0.118  0.     0.     0.     0.096  0.    -0.     0.   ]
 [ 0.     0.     0.    -0.115  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.    -0.168  0.    -0.118  0.     0.     0.     0.096  0.    -0.   ]
 [-0.168  0.     0.     0.     0.034  0.    -0.077  0.    -0.     0.    -0.148  0.    -0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.    -0.168  0.     0.     0.     0.034  0.    -0.077  0.    -0.     0.    -0.148  0.    -0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [-0.118  0.     0.     0.    -0.077  0.    -0.565  0.     0.2    0.    -0.     0.    -0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.    -0.118  0.     0.     0.    -0.077  0.    -0.565  0.     0.2    0.    -0.     0.    -0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.    -0.     0.     0.2    0.    -0.624  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.    -0.     0.     0.2    0.    -0.624  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.096  0.     0.     0.    -0.148  0.    -0.     0.     0.     0.     0.553  0.     0.208  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.096  0.     0.     0.    -0.148  0.    -0.     0.     0.     0.     0.553  0.     0.208  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [-0.     0.     0.     0.    -0.     0.    -0.     0.     0.     0.     0.208  0.     0.602  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.    -0.     0.     0.     0.    -0.     0.    -0.     0.     0.     0.     0.208  0.     0.602  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.    -0.168  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.034  0.    -0.077  0.    -0.     0.    -0.148  0.    -0.     0.   ]
 [ 0.     0.     0.    -0.168  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.034  0.    -0.077  0.    -0.     0.    -0.148  0.    -0.   ]
 [ 0.     0.    -0.118  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.    -0.077  0.    -0.565  0.     0.2    0.    -0.     0.    -0.     0.   ]
 [ 0.     0.     0.    -0.118  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.    -0.077  0.    -0.565  0.     0.2    0.    -0.     0.    -0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.    -0.     0.     0.2    0.    -0.624  0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.    -0.     0.     0.2    0.    -0.624  0.     0.     0.     0.   ]
 [ 0.     0.     0.096  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.    -0.148  0.    -0.     0.     0.     0.     0.553  0.     0.208  0.   ]
 [ 0.     0.     0.     0.096  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.    -0.148  0.    -0.     0.     0.     0.     0.553  0.     0.208]
 [ 0.     0.    -0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.    -0.     0.    -0.     0.     0.     0.     0.208  0.     0.602  0.   ]
 [ 0.     0.     0.    -0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.    -0.     0.    -0.     0.     0.     0.     0.208  0.     0.602]]
C_ab = 
