******************************************
******************************************
NF = 18, M = 9, Nimp = 1
******************************************
[[-0.25   0.     0.103  0.     0.124  0.     0.124  0.     0.103  0.     0.103  0.     0.124  0.     0.124  0.     0.103  0.   ]
 [ 0.    -0.25   0.     0.103  0.     0.124  0.     0.124  0.     0.103  0.     0.103  0.     0.124  0.     0.124  0.     0.103]
 [ 0.103  0.    -2.    -0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.103 -0.    -2.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.124  0.     0.     0.    -1.5   -0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.124  0.     0.    -0.    -1.5    0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.124  0.     0.     0.     0.     0.    -1.    -0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.124  0.     0.     0.     0.    -0.    -1.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.103  0.     0.     0.     0.     0.     0.     0.    -0.5   -0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.103  0.     0.     0.     0.     0.     0.    -0.    -0.5    0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.103  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.5    0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.103  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.5    0.     0.     0.     0.     0.     0.   ]
 [ 0.124  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     1.     0.     0.     0.     0.     0.   ]
 [ 0.     0.124  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     1.     0.     0.     0.     0.   ]
 [ 0.124  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     1.5    0.     0.     0.   ]
 [ 0.     0.124  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     1.5    0.     0.   ]
 [ 0.103  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     2.     0.   ]
 [ 0.     0.103  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     2.   ]]
************
[[-0.25   0.103  0.124  0.124  0.103  0.103  0.124  0.124  0.103]
 [ 0.103 -2.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.124  0.    -1.5    0.     0.     0.     0.     0.     0.   ]
 [ 0.124  0.     0.    -1.     0.     0.     0.     0.     0.   ]
 [ 0.103  0.     0.     0.    -0.5    0.     0.     0.     0.   ]
 [ 0.103  0.     0.     0.     0.     0.5    0.     0.     0.   ]
 [ 0.124  0.     0.     0.     0.     0.     1.     0.     0.   ]
 [ 0.124  0.     0.     0.     0.     0.     0.     1.5    0.   ]
 [ 0.103  0.     0.     0.     0.     0.     0.     0.     2.   ]]
U((0, 0, 0, 0)) = (0.5+0j)
setting to 0
U((0, 9, 0, 9)) = (0.5+0j)
U((9, 0, 9, 0)) = (0.5+0j)
U((9, 9, 9, 9)) = (0.5+0j)
setting to 0
h0_0 size:  (18, 18)
U_0 size:  (18, 18, 18, 18)
Going with Nelec_imp = 1, nbath = 8, Nelec = 9
imp_indices_full = [0, 9]
h0_0 = 
[[-0.25   0.103  0.124  0.124  0.103  0.103  0.124  0.124  0.103  0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.103 -2.     0.     0.     0.     0.     0.     0.     0.     0.    -0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.124  0.    -1.5    0.     0.     0.     0.     0.     0.     0.     0.    -0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.124  0.     0.    -1.     0.     0.     0.     0.     0.     0.     0.     0.    -0.     0.     0.     0.     0.     0.   ]
 [ 0.103  0.     0.     0.    -0.5    0.     0.     0.     0.     0.     0.     0.     0.    -0.     0.     0.     0.     0.   ]
 [ 0.103  0.     0.     0.     0.     0.5    0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.124  0.     0.     0.     0.     0.     1.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.124  0.     0.     0.     0.     0.     0.     1.5    0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.103  0.     0.     0.     0.     0.     0.     0.     2.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.    -0.25   0.103  0.124  0.124  0.103  0.103  0.124  0.124  0.103]
 [ 0.    -0.     0.     0.     0.     0.     0.     0.     0.     0.103 -2.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.    -0.     0.     0.     0.     0.     0.     0.     0.124  0.    -1.5    0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.    -0.     0.     0.     0.     0.     0.     0.124  0.     0.    -1.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.    -0.     0.     0.     0.     0.     0.103  0.     0.     0.    -0.5    0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.103  0.     0.     0.     0.     0.5    0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.124  0.     0.     0.     0.     0.     1.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.124  0.     0.     0.     0.     0.     0.     1.5    0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.103  0.     0.     0.     0.     0.     0.     0.     2.   ]]


--------------------------------------------------------------
Mean-Field Self-Consistent Procedure with block handling
--------------------------------------------------------------
[V1] mfscf proc with Ne=9, maxiter=100, alpha=0.2, threshold=1e-07, spinsym_only = False
[V1] Symmetry analysis found 2 blocks.
[V1] Found 1 unique groups of blocks.
[V1] Blocks: [[0, 1, 2, 3, 4, 5, 6, 7, 8], [9, 10, 11, 12, 13, 14, 15, 16, 17]]
[V1] Identical Groups (by block index): [[0, 1]]
[V1] iter 0, Tr(rho*h0) = -10.36242660
[V1] Ne = 9, initial tr(rho) = 9.00000000+0.00000000j
[V1] mixing parameter: α = 0.2
[V2] Number of non-zero U elements: 2
[V1] Iter         E_total          E_corr        ΔE_total
[V2] U is sparse, using nzU
[V1]    1    -10.21007587     -0.15235073      1.0102e+03
[V1]   10    -10.22408174     -0.12793229      5.0524e-04
[V1]   20    -10.22586638     -0.12525652      5.3280e-05
[V1]   30    -10.22605646     -0.12502255      5.7134e-06
[V1]   40    -10.22607686     -0.12500198      6.1341e-07
[V1] Converged in 49 iterations.
[V1] Final tr(rho) = 9.00000000+0.00000000j
[V2] Reordering final eigenvectors to spin-blocked convention...
hmf = 
[[ 0.     0.103  0.124  0.124  0.103  0.103  0.124  0.124  0.103  0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.103 -2.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.124  0.    -1.5    0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.124  0.     0.    -1.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.103  0.     0.     0.    -0.5    0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.103  0.     0.     0.     0.     0.5    0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.124  0.     0.     0.     0.     0.     1.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.124  0.     0.     0.     0.     0.     0.     1.5    0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.103  0.     0.     0.     0.     0.     0.     0.     2.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.103  0.124  0.124  0.103  0.103  0.124  0.124  0.103]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.103 -2.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.124  0.    -1.5    0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.124  0.     0.    -1.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.103  0.     0.     0.    -0.5    0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.103  0.     0.     0.     0.     0.5    0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.124  0.     0.     0.     0.     0.     1.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.124  0.     0.     0.     0.     0.     0.     1.5    0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.103  0.     0.     0.     0.     0.     0.     0.     2.   ]]
DEBUG, Nimp_sf = 2
hmf_ab = 
[[ 0.   +0.j  0.   +0.j  0.103+0.j  0.   +0.j  0.124+0.j  0.   +0.j  0.124+0.j  0.   +0.j  0.103+0.j  0.   +0.j  0.103+0.j  0.   +0.j  0.124+0.j  0.   +0.j  0.124+0.j  0.   +0.j  0.103+0.j  0.   +0.j]
 [ 0.   +0.j  0.   +0.j  0.   +0.j  0.103+0.j  0.   +0.j  0.124+0.j  0.   +0.j  0.124+0.j  0.   +0.j  0.103+0.j  0.   +0.j  0.103+0.j  0.   +0.j  0.124+0.j  0.   +0.j  0.124+0.j  0.   +0.j  0.103+0.j]
 [ 0.103+0.j  0.   +0.j -2.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j]
 [ 0.   +0.j  0.103+0.j  0.   +0.j -2.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j]
 [ 0.124+0.j  0.   +0.j  0.   +0.j  0.   +0.j -1.5  +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j]
 [ 0.   +0.j  0.124+0.j  0.   +0.j  0.   +0.j  0.   +0.j -1.5  +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j]
 [ 0.124+0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j -1.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j]
 [ 0.   +0.j  0.124+0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j -1.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j]
 [ 0.103+0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j -0.5  +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j]
 [ 0.   +0.j  0.103+0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j -0.5  +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j]
 [ 0.103+0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.5  +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j]
 [ 0.   +0.j  0.103+0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.5  +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j]
 [ 0.124+0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  1.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j]
 [ 0.   +0.j  0.124+0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  1.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j]
 [ 0.124+0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  1.5  +0.j  0.   +0.j  0.   +0.j  0.   +0.j]
 [ 0.   +0.j  0.124+0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  1.5  +0.j  0.   +0.j  0.   +0.j]
 [ 0.103+0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  2.   +0.j  0.   +0.j]
 [ 0.   +0.j  0.103+0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  0.   +0.j  2.   +0.j]]

--- Analyzed Structure ---
Found 2 blocks
Blocks: [[0, 2, 4, 6, 8, 10, 12, 14, 16], [1, 3, 5, 7, 9, 11, 13, 15, 17]]
Identical Groups (by block index): [[0, 1]]
[blocks] 2 blocks; identical groups: [[0, 1]]
[check] Tr rho = 8.999999999950, sum blocks = 8.000000000000, Nelec = 9
[leader block 0] size=9 Nimp_b=1 Nelec_b=4
DEBUG: C1 = 
[[ 1.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.201 -0.948  0.     0.247  0.     0.002  0.002 -0.002]
 [ 0.     0.323  0.131  0.906  0.24   0.     0.004  0.004 -0.004]
 [ 0.     0.482  0.29  -0.405  0.721  0.001  0.007  0.008 -0.007]
 [ 0.     0.788  0.011 -0.124 -0.602  0.003  0.014  0.017 -0.018]
 [ 0.     0.021  0.001 -0.002 -0.005 -0.581 -0.088 -0.124  0.799]
 [ 0.     0.018  0.001 -0.001 -0.003  0.662  0.021 -0.643  0.383]
 [ 0.     0.014  0.001 -0.001 -0.002 -0.362 -0.529 -0.641 -0.422]
 [ 0.     0.009  0.    -0.001 -0.001  0.304 -0.843  0.4    0.191]]
DEBUG: C2 = 
[[ 1.  0.  0.  0.  0.  0.  0.  0.  0.]
 [ 0. -1.  0.  0.  0.  0.  0.  0.  0.]
 [ 0.  0.  1.  0.  0.  0.  0.  0.  0.]
 [ 0.  0.  0.  1.  0.  0.  0.  0.  0.]
 [ 0.  0.  0.  0.  1.  0.  0.  0.  0.]
 [ 0.  0.  0.  0.  0.  1.  0.  0.  0.]
 [ 0.  0.  0.  0.  0.  0.  1.  0.  0.]
 [ 0.  0.  0.  0.  0.  0.  0.  1.  0.]
 [ 0.  0.  0.  0.  0.  0.  0.  0.  1.]]
DEBUG: C3 = 
[[ 0.243 -0.97   0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.97   0.243  0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     1.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     1.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     1.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     1.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     1.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     1.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     1.   ]]
DEBUG: C4 = 
[[ 1.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     1.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.    -0.416  0.845 -0.337  0.     0.     0.     0.   ]
 [ 0.     0.     0.468 -0.119 -0.876  0.     0.     0.     0.   ]
 [ 0.     0.     0.78   0.522  0.346  0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.    -0.042 -0.307  0.284 -0.907]
 [ 0.     0.     0.     0.     0.     0.7    0.638  0.275 -0.162]
 [ 0.     0.     0.     0.     0.     0.575 -0.353 -0.726 -0.135]
 [ 0.     0.     0.     0.     0.    -0.421  0.612 -0.563 -0.364]]
DEBUG: C_total = 
[[ 0.243 -0.97   0.     0.     0.     0.     0.     0.     0.   ]
 [-0.195 -0.049  0.587 -0.672  0.404  0.004 -0.001  0.    -0.   ]
 [-0.314 -0.079  0.556  0.128 -0.755  0.007 -0.001  0.    -0.   ]
 [-0.468 -0.117  0.252  0.669  0.506  0.013 -0.003  0.001 -0.   ]
 [-0.765 -0.192 -0.532 -0.29  -0.103  0.028 -0.009  0.003 -0.001]
 [-0.02  -0.005 -0.005 -0.001 -0.    -0.445  0.655 -0.549  0.268]
 [-0.017 -0.004 -0.003 -0.001 -0.    -0.544  0.272  0.445 -0.657]
 [-0.013 -0.003 -0.002 -0.    -0.    -0.547 -0.259  0.454  0.654]
 [-0.009 -0.002 -0.001 -0.    -0.    -0.454 -0.656 -0.543 -0.263]]
DEBUG: C_total_restored = 
[[ 1.    -0.     0.     0.     0.     0.     0.     0.     0.   ]
 [-0.    -0.201  0.587 -0.672  0.404  0.004 -0.001  0.    -0.   ]
 [ 0.    -0.323  0.556  0.128 -0.755  0.007 -0.001  0.    -0.   ]
 [-0.    -0.482  0.252  0.669  0.506  0.013 -0.003  0.001 -0.   ]
 [ 0.    -0.788 -0.532 -0.29  -0.103  0.028 -0.009  0.003 -0.001]
 [-0.    -0.021 -0.005 -0.001 -0.    -0.445  0.655 -0.549  0.268]
 [-0.    -0.018 -0.003 -0.001 -0.    -0.544  0.272  0.445 -0.657]
 [ 0.    -0.014 -0.002 -0.    -0.    -0.547 -0.259  0.454  0.654]
 [-0.    -0.009 -0.001 -0.    -0.    -0.454 -0.656 -0.543 -0.263]]
h_block_final:
[[ 0.    -0.209  0.105  0.    -0.    -0.222  0.    -0.    -0.   ]
 [-0.209 -0.78   0.418 -0.     0.     0.056  0.     0.    -0.   ]
 [ 0.105  0.418 -1.358  0.436 -0.     0.     0.     0.    -0.   ]
 [ 0.    -0.     0.436 -1.418  0.335  0.     0.     0.    -0.   ]
 [-0.     0.    -0.     0.335 -1.443  0.    -0.    -0.    -0.   ]
 [-0.222  0.056  0.     0.     0.     1.255  0.515 -0.     0.   ]
 [ 0.     0.     0.     0.    -0.     0.515  1.249  0.477 -0.   ]
 [-0.     0.     0.     0.    -0.    -0.     0.477  1.247  0.364]
 [-0.    -0.    -0.    -0.    -0.     0.    -0.     0.364  1.247]]
C_block:
[[ 1.    -0.     0.     0.     0.     0.     0.     0.     0.   ]
 [-0.    -0.201  0.587 -0.672  0.404  0.004 -0.001  0.    -0.   ]
 [ 0.    -0.323  0.556  0.128 -0.755  0.007 -0.001  0.    -0.   ]
 [-0.    -0.482  0.252  0.669  0.506  0.013 -0.003  0.001 -0.   ]
 [ 0.    -0.788 -0.532 -0.29  -0.103  0.028 -0.009  0.003 -0.001]
 [-0.    -0.021 -0.005 -0.001 -0.    -0.445  0.655 -0.549  0.268]
 [-0.    -0.018 -0.003 -0.001 -0.    -0.544  0.272  0.445 -0.657]
 [ 0.    -0.014 -0.002 -0.    -0.    -0.547 -0.259  0.454  0.654]
 [-0.    -0.009 -0.001 -0.    -0.    -0.454 -0.656 -0.543 -0.263]]
[sanity] ||h_final - C^† h C|| / ||h|| = 0.000e+00
hdc_ab = 
[[ 0.     0.    -0.209  0.     0.105  0.     0.     0.    -0.     0.    -0.222  0.     0.     0.    -0.     0.    -0.     0.   ]
 [ 0.     0.     0.    -0.209  0.     0.105  0.     0.     0.    -0.     0.    -0.222  0.     0.     0.    -0.     0.    -0.   ]
 [-0.209  0.    -0.78   0.     0.418  0.    -0.     0.     0.     0.     0.056  0.     0.     0.     0.     0.    -0.     0.   ]
 [ 0.    -0.209  0.    -0.78   0.     0.418  0.    -0.     0.     0.     0.     0.056  0.     0.     0.     0.     0.    -0.   ]
 [ 0.105  0.     0.418  0.    -1.358  0.     0.436  0.    -0.     0.     0.     0.     0.     0.     0.     0.    -0.     0.   ]
 [ 0.     0.105  0.     0.418  0.    -1.358  0.     0.436  0.    -0.     0.     0.     0.     0.     0.     0.     0.    -0.   ]
 [ 0.     0.    -0.     0.     0.436  0.    -1.418  0.     0.335  0.     0.     0.     0.     0.     0.     0.    -0.     0.   ]
 [ 0.     0.     0.    -0.     0.     0.436  0.    -1.418  0.     0.335  0.     0.     0.     0.     0.     0.     0.    -0.   ]
 [-0.     0.     0.     0.    -0.     0.     0.335  0.    -1.443  0.     0.     0.    -0.     0.    -0.     0.    -0.     0.   ]
 [ 0.    -0.     0.     0.     0.    -0.     0.     0.335  0.    -1.443  0.     0.     0.    -0.     0.    -0.     0.    -0.   ]
 [-0.222  0.     0.056  0.     0.     0.     0.     0.     0.     0.     1.255  0.     0.515  0.    -0.     0.     0.     0.   ]
 [ 0.    -0.222  0.     0.056  0.     0.     0.     0.     0.     0.     0.     1.255  0.     0.515  0.    -0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.    -0.     0.     0.515  0.     1.249  0.     0.477  0.    -0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.    -0.     0.     0.515  0.     1.249  0.     0.477  0.    -0.   ]
 [-0.     0.     0.     0.     0.     0.     0.     0.    -0.     0.    -0.     0.     0.477  0.     1.247  0.     0.364  0.   ]
 [ 0.    -0.     0.     0.     0.     0.     0.     0.     0.    -0.     0.    -0.     0.     0.477  0.     1.247  0.     0.364]
 [-0.     0.    -0.     0.    -0.     0.    -0.     0.    -0.     0.     0.     0.    -0.     0.     0.364  0.     1.247  0.   ]
 [ 0.    -0.     0.    -0.     0.    -0.     0.    -0.     0.    -0.     0.     0.     0.    -0.     0.     0.364  0.     1.247]]
C_ab = 
[[ 1.     0.    -0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     1.     0.    -0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [-0.     0.    -0.201  0.     0.587  0.    -0.672  0.     0.404  0.     0.004  0.    -0.001  0.     0.     0.    -0.     0.   ]
 [ 0.    -0.     0.    -0.201  0.     0.587  0.    -0.672  0.     0.404  0.     0.004  0.    -0.001  0.     0.     0.    -0.   ]
 [ 0.     0.    -0.323  0.     0.556  0.     0.128  0.    -0.755  0.     0.007  0.    -0.001  0.     0.     0.    -0.     0.   ]
 [ 0.     0.     0.    -0.323  0.     0.556  0.     0.128  0.    -0.755  0.     0.007  0.    -0.001  0.     0.     0.    -0.   ]
 [-0.     0.    -0.482  0.     0.252  0.     0.669  0.     0.506  0.     0.013  0.    -0.003  0.     0.001  0.    -0.     0.   ]
 [ 0.    -0.     0.    -0.482  0.     0.252  0.     0.669  0.     0.506  0.     0.013  0.    -0.003  0.     0.001  0.    -0.   ]
 [ 0.     0.    -0.788  0.    -0.532  0.    -0.29   0.    -0.103  0.     0.028  0.    -0.009  0.     0.003  0.    -0.001  0.   ]
 [ 0.     0.     0.    -0.788  0.    -0.532  0.    -0.29   0.    -0.103  0.     0.028  0.    -0.009  0.     0.003  0.    -0.001]
 [-0.     0.    -0.021  0.    -0.005  0.    -0.001  0.    -0.     0.    -0.445  0.     0.655  0.    -0.549  0.     0.268  0.   ]
 [ 0.    -0.     0.    -0.021  0.    -0.005  0.    -0.001  0.    -0.     0.    -0.445  0.     0.655  0.    -0.549  0.     0.268]
 [-0.     0.    -0.018  0.    -0.003  0.    -0.001  0.    -0.     0.    -0.544  0.     0.272  0.     0.445  0.    -0.657  0.   ]
 [ 0.    -0.     0.    -0.018  0.    -0.003  0.    -0.001  0.    -0.     0.    -0.544  0.     0.272  0.     0.445  0.    -0.657]
 [ 0.     0.    -0.014  0.    -0.002  0.    -0.     0.    -0.     0.    -0.547  0.    -0.259  0.     0.454  0.     0.654  0.   ]
 [ 0.     0.     0.    -0.014  0.    -0.002  0.    -0.     0.    -0.     0.    -0.547  0.    -0.259  0.     0.454  0.     0.654]
 [-0.     0.    -0.009  0.    -0.001  0.    -0.     0.    -0.     0.    -0.454  0.    -0.656  0.    -0.543  0.    -0.263  0.   ]
 [ 0.    -0.     0.    -0.009  0.    -0.001  0.    -0.     0.    -0.     0.    -0.454  0.    -0.656  0.    -0.543  0.    -0.263]]
C = 
[[ 1.    -0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [-0.    -0.201  0.587 -0.672  0.404  0.004 -0.001  0.    -0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.    -0.323  0.556  0.128 -0.755  0.007 -0.001  0.    -0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [-0.    -0.482  0.252  0.669  0.506  0.013 -0.003  0.001 -0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.    -0.788 -0.532 -0.29  -0.103  0.028 -0.009  0.003 -0.001  0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [-0.    -0.021 -0.005 -0.001 -0.    -0.445  0.655 -0.549  0.268  0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [-0.    -0.018 -0.003 -0.001 -0.    -0.544  0.272  0.445 -0.657  0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.    -0.014 -0.002 -0.    -0.    -0.547 -0.259  0.454  0.654  0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [-0.    -0.009 -0.001 -0.    -0.    -0.454 -0.656 -0.543 -0.263  0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     1.    -0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.    -0.    -0.201  0.587 -0.672  0.404  0.004 -0.001  0.    -0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.    -0.323  0.556  0.128 -0.755  0.007 -0.001  0.    -0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.    -0.    -0.482  0.252  0.669  0.506  0.013 -0.003  0.001 -0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.    -0.788 -0.532 -0.29  -0.103  0.028 -0.009  0.003 -0.001]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.    -0.    -0.021 -0.005 -0.001 -0.    -0.445  0.655 -0.549  0.268]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.    -0.    -0.018 -0.003 -0.001 -0.    -0.544  0.272  0.445 -0.657]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.    -0.014 -0.002 -0.    -0.    -0.547 -0.259  0.454  0.654]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.    -0.    -0.009 -0.001 -0.    -0.    -0.454 -0.656 -0.543 -0.263]]
******************************************
h0_0 = 
[[-0.25  -0.209  0.105  0.    -0.    -0.222  0.    -0.    -0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [-0.209 -0.78   0.418 -0.     0.     0.056  0.     0.    -0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.105  0.418 -1.358  0.436 -0.     0.     0.     0.    -0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.    -0.     0.436 -1.418  0.335  0.     0.     0.    -0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [-0.     0.    -0.     0.335 -1.443  0.    -0.    -0.    -0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [-0.222  0.056  0.     0.     0.     1.255  0.515 -0.     0.     0.    -0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.    -0.     0.515  1.249  0.477 -0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [-0.     0.     0.     0.    -0.    -0.     0.477  1.247  0.364  0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [-0.    -0.    -0.    -0.    -0.     0.    -0.     0.364  1.247  0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.    -0.25  -0.209  0.105  0.    -0.    -0.222  0.    -0.    -0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.    -0.209 -0.78   0.418 -0.     0.     0.056  0.     0.    -0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.105  0.418 -1.358  0.436 -0.     0.     0.     0.    -0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.    -0.     0.436 -1.418  0.335  0.     0.     0.    -0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.    -0.     0.    -0.     0.335 -1.443  0.    -0.    -0.    -0.   ]
 [ 0.    -0.     0.     0.     0.     0.     0.     0.     0.    -0.222  0.056  0.     0.     0.     1.255  0.515 -0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.    -0.     0.515  1.249  0.477 -0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.    -0.     0.     0.     0.    -0.    -0.     0.477  1.247  0.364]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.    -0.    -0.    -0.    -0.    -0.     0.    -0.     0.364  1.247]]
h0_legacy = 
[[-0.25   0.103  0.124  0.124  0.103  0.103  0.124  0.124  0.103  0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.103 -2.     0.     0.     0.     0.     0.     0.     0.     0.    -0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.124  0.    -1.5    0.     0.     0.     0.     0.     0.     0.     0.    -0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.124  0.     0.    -1.     0.     0.     0.     0.     0.     0.     0.     0.    -0.     0.     0.     0.     0.     0.   ]
 [ 0.103  0.     0.     0.    -0.5    0.     0.     0.     0.     0.     0.     0.     0.    -0.     0.     0.     0.     0.   ]
 [ 0.103  0.     0.     0.     0.     0.5    0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.124  0.     0.     0.     0.     0.     1.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.124  0.     0.     0.     0.     0.     0.     1.5    0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.103  0.     0.     0.     0.     0.     0.     0.     2.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.    -0.25   0.103  0.124  0.124  0.103  0.103  0.124  0.124  0.103]
 [ 0.    -0.     0.     0.     0.     0.     0.     0.     0.     0.103 -2.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.    -0.     0.     0.     0.     0.     0.     0.     0.124  0.    -1.5    0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.    -0.     0.     0.     0.     0.     0.     0.124  0.     0.    -1.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.    -0.     0.     0.     0.     0.     0.103  0.     0.     0.    -0.5    0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.103  0.     0.     0.     0.     0.5    0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.124  0.     0.     0.     0.     0.     1.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.124  0.     0.     0.     0.     0.     0.     1.5    0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.103  0.     0.     0.     0.     0.     0.     0.     2.   ]]
Partitioning system: 1 impurity orbitals, 8 bath orbitals.
Generating basis for 1 electrons on impurity and 8 on bath.
Found 2 impurity configurations and 1 bath configurations.
Generated a total of 2 unique starting determinants.
sb = [<SlaterDeterminant α=[1, 2, 3, 4] β=[0, 1, 2, 3, 4]>, <SlaterDeterminant α=[0, 1, 2, 3, 4] β=[1, 2, 3, 4]>]
DEBUG: build ham time = 0.0005228519439697266
[init] dim=2  E0=-10.246579421914
blocks = [-0.5, 0.5], time block = 9.059906005859375e-06
apply_ham time = 1.9073486328125e-05
gen basis time = 4.38690185546875e-05
sel basis time = 3.600120544433594e-05
Found 2 S_z blocks: [-0.5, 0.5]
  Processing Sz=-0.5 block of size 6x6
DEBUG: build ham time = 0.00037789344787597656
  Processing Sz=0.5 block of size 6x6
DEBUG: build ham time = 0.00036978721618652344
DEBUG: finished rearranging vectors
DEBUG: for basis size 12, ham diag time = 0.0010161399841308594
[iter 0] dim=    12  Es=[-10.321169839799 -10.321169839799]  |dE0|=7.459e-02
blocks = [-0.5, 0.5], time block = 1.52587890625e-05
apply_ham time = 6.580352783203125e-05
gen basis time = 0.0001239776611328125
sel basis time = 6.794929504394531e-05
Found 2 S_z blocks: [-0.5, 0.5]
  Processing Sz=-0.5 block of size 19x19
DEBUG: build ham time = 0.0003960132598876953
  Processing Sz=0.5 block of size 19x19
DEBUG: build ham time = 0.00039196014404296875
DEBUG: finished rearranging vectors
DEBUG: for basis size 38, ham diag time = 0.001096963882446289
[iter 1] dim=    38  Es=[-10.328302489953 -10.328302489953]  |dE0|=7.133e-03
blocks = [-0.5, 0.5], time block = 3.314018249511719e-05
apply_ham time = 0.0001990795135498047
gen basis time = 0.0003299713134765625
sel basis time = 0.00013303756713867188
Found 2 S_z blocks: [-0.5, 0.5]
  Processing Sz=-0.5 block of size 47x47
DEBUG: build ham time = 0.0004401206970214844
  Processing Sz=0.5 block of size 47x47
DEBUG: build ham time = 0.00044417381286621094
DEBUG: finished rearranging vectors
DEBUG: for basis size 94, ham diag time = 0.0019648075103759766
[iter 2] dim=    94  Es=[-10.329442927574 -10.329442927574]  |dE0|=1.140e-03
blocks = [-0.5, 0.5], time block = 7.867813110351562e-05
apply_ham time = 0.0005068778991699219
gen basis time = 0.0007836818695068359
sel basis time = 0.0002491474151611328
Found 2 S_z blocks: [-0.5, 0.5]
  Processing Sz=-0.5 block of size 103x103
DEBUG: build ham time = 0.0005528926849365234
  Processing Sz=0.5 block of size 103x103
DEBUG: build ham time = 0.0007448196411132812
DEBUG: finished rearranging vectors
DEBUG: for basis size 206, ham diag time = 0.07609796524047852
[iter 3] dim=   206  Es=[-10.329577320970 -10.329577320966]  |dE0|=1.344e-04
blocks = [-0.5, 0.5], time block = 0.0001761913299560547
apply_ham time = 0.001107931137084961
gen basis time = 0.0016779899597167969
sel basis time = 0.0005009174346923828
Found 2 S_z blocks: [-0.5, 0.5]
  Processing Sz=-0.5 block of size 189x189
DEBUG: build ham time = 0.0007450580596923828
  Processing Sz=0.5 block of size 189x189
DEBUG: build ham time = 0.0008869171142578125
DEBUG: finished rearranging vectors
DEBUG: for basis size 378, ham diag time = 0.14374685287475586
[iter 4] dim=   378  Es=[-10.329584609694 -10.329584609694]  |dE0|=7.289e-06
[conv] reached |dE| < 1e-05
Found 2 S_z blocks: [-0.5, 0.5]
  Processing Sz=-0.5 block of size 189x189
DEBUG: build ham time = 0.0008780956268310547
  Processing Sz=0.5 block of size 189x189
DEBUG: build ham time = 0.0009169578552246094
DEBUG: finished rearranging vectors
sci total time : 0.45456600189208984
energies = [-10.33 -10.33], e0 = -10.32958460969439
len basis = 378
len(basis(psis0)) = 378
target_indices = [0, 9]
 Founds blocks : [[0], [1]]
  Symmetry: is_diagonal=True. Found 1 unique group(s) of blocks.
  Computing representative g_(0,0) via Scalar CF...
DEBUG: build ham time = 0.0008959770202636719
DEBUG: build ham time = 0.0008599758148193359
target_indices = [0, 9]
 Founds blocks : [[0], [1]]
  Symmetry: is_diagonal=True. Found 1 unique group(s) of blocks.
  Computing representative g_(0,0) via Scalar CF...
DEBUG: build ham time = 0.0008640289306640625
DEBUG: build ham time = 0.0011448860168457031
rdm : 
[[0.5+0.j 0. +0.j]
 [0. +0.j 0.5+0.j]]
impurity occupation: (1.0000000154645905+0j)
total occupation : (1.0000000154645905+0j)

Thermally-averaged calculation finished.
Data saved to 'dump/A_8'
