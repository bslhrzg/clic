******************************************
******************************************
NF = 38, M = 19, Nimp = 1
******************************************
[[-0.25   0.     0.057 ...  0.     0.057  0.   ]
 [ 0.    -0.25   0.    ...  0.073  0.     0.057]
 [ 0.057  0.    -2.139 ...  0.     0.     0.   ]
 ...
 [ 0.     0.073  0.    ...  1.917  0.     0.   ]
 [ 0.057  0.     0.    ...  0.     2.139  0.   ]
 [ 0.     0.057  0.    ...  0.     0.     2.139]]
************
[[-0.25   0.057  0.073  0.08   0.083  0.084  0.083  0.08   0.073  0.057  0.057  0.073  0.08   0.083  0.084  0.083  0.08   0.073  0.057]
 [ 0.057 -2.139  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.073  0.    -1.917  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.08   0.     0.    -1.694  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.083  0.     0.     0.    -1.472  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.084  0.     0.     0.     0.    -1.25   0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.083  0.     0.     0.     0.     0.    -1.028  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.08   0.     0.     0.     0.     0.     0.    -0.806  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.073  0.     0.     0.     0.     0.     0.     0.    -0.583  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.057  0.     0.     0.     0.     0.     0.     0.     0.    -0.361  0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.057  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.361  0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.073  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.583  0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.08   0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.806  0.     0.     0.     0.     0.     0.   ]
 [ 0.083  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     1.028  0.     0.     0.     0.     0.   ]
 [ 0.084  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     1.25   0.     0.     0.     0.   ]
 [ 0.083  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     1.472  0.     0.     0.   ]
 [ 0.08   0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     1.694  0.     0.   ]
 [ 0.073  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     1.917  0.   ]
 [ 0.057  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     2.139]]
U((0, 0, 0, 0)) = (0.5+0j)
setting to 0
U((0, 19, 0, 19)) = (0.5+0j)
U((19, 0, 19, 0)) = (0.5+0j)
U((19, 19, 19, 19)) = (0.5+0j)
setting to 0
h0_0 size:  (38, 38)
U_0 size:  (38, 38, 38, 38)
Going with Nelec_imp = 1, nbath = 18, Nelec = 19
imp_indices_full = [0, 19]
h0_0 = 
[[-0.25   0.057  0.073 ...  0.     0.     0.   ]
 [ 0.057 -2.139  0.    ...  0.     0.     0.   ]
 [ 0.073  0.    -1.917 ...  0.     0.     0.   ]
 ...
 [ 0.     0.     0.    ...  1.694  0.     0.   ]
 [ 0.     0.     0.    ...  0.     1.917  0.   ]
 [ 0.     0.     0.    ...  0.     0.     2.139]]


--------------------------------------------------------------
Mean-Field Self-Consistent Procedure with block handling
--------------------------------------------------------------
[V1] mfscf proc with Ne=19, maxiter=100, alpha=0.2, threshold=1e-07, spinsym_only = False
[V1] Symmetry analysis found 2 blocks.
[V1] Found 1 unique groups of blocks.
[V1] Blocks: [[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18], [19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37]]
[V1] Identical Groups (by block index): [[0, 1]]
[V1] iter 0, Tr(rho*h0) = -22.86337273
[V1] Ne = 19, initial tr(rho) = 19.00000000+0.00000000j
[V1] mixing parameter: α = 0.2
[V2] Number of non-zero U elements: 2
[V1] Iter         E_total          E_corr        ΔE_total
[V2] U is sparse, using nzU
[V1]    1    -22.69913596     -0.16423677      1.0227e+03
[V1]   10    -22.72097881     -0.12902388      7.7235e-04
[V1]   20    -22.72369969     -0.12534120      8.1097e-05
[V1]   30    -22.72398898     -0.12502913      8.6944e-06
[V1]   40    -22.72402003     -0.12500249      9.3346e-07
[V1]   50    -22.72402336     -0.12500021      1.0023e-07
[V1] Converged in 51 iterations.
[V1] Final tr(rho) = 19.00000000+0.00000000j
[V2] Reordering final eigenvectors to spin-blocked convention...
hmf = 
[[ 0.     0.057  0.073 ...  0.     0.     0.   ]
 [ 0.057 -2.139  0.    ...  0.     0.     0.   ]
 [ 0.073  0.    -1.917 ...  0.     0.     0.   ]
 ...
 [ 0.     0.     0.    ...  1.694  0.     0.   ]
 [ 0.     0.     0.    ...  0.     1.917  0.   ]
 [ 0.     0.     0.    ...  0.     0.     2.139]]
DEBUG, Nimp_sf = 2
hmf_ab = 
[[ 0.   +0.j  0.   +0.j  0.057+0.j ...  0.   +0.j  0.057+0.j  0.   +0.j]
 [ 0.   +0.j  0.   +0.j  0.   +0.j ...  0.073+0.j  0.   +0.j  0.057+0.j]
 [ 0.057+0.j  0.   +0.j -2.139+0.j ...  0.   +0.j  0.   +0.j  0.   +0.j]
 ...
 [ 0.   +0.j  0.073+0.j  0.   +0.j ...  1.917+0.j  0.   +0.j  0.   +0.j]
 [ 0.057+0.j  0.   +0.j  0.   +0.j ...  0.   +0.j  2.139+0.j  0.   +0.j]
 [ 0.   +0.j  0.057+0.j  0.   +0.j ...  0.   +0.j  0.   +0.j  2.139+0.j]]

--- Analyzed Structure ---
Found 2 blocks
Blocks: [[0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36], [1, 3, 5, 7, 9, 11, 13, 15, 17, 19, 21, 23, 25, 27, 29, 31, 33, 35, 37]]
Identical Groups (by block index): [[0, 1]]
[blocks] 2 blocks; identical groups: [[0, 1]]
[check] Tr rho = 19.000000000008, sum blocks = 20.000000000000, Nelec = 19
[leader block 0] size=19 Nimp_b=1 Nelec_b=10
DEBUG: C1 = 
[[ 1.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.005  0.043 -0.006  0.076  0.012  0.043  0.139 -0.051  0.976 -0.123  0.     0.     0.    -0.001 -0.    -0.     0.    -0.   ]
 [ 0.     0.007 -0.315  0.416  0.3    0.167 -0.293 -0.112 -0.706 -0.003  0.112 -0.     0.     0.    -0.001 -0.    -0.     0.    -0.   ]
 [ 0.     0.008  0.802  0.086 -0.098  0.373  0.208 -0.06  -0.297 -0.016  0.256 -0.     0.     0.    -0.001 -0.    -0.    -0.    -0.   ]
 [ 0.     0.01   0.078  0.087 -0.095  0.203  0.132  0.136 -0.197 -0.149 -0.916 -0.     0.     0.    -0.002  0.    -0.    -0.    -0.   ]
 [ 0.     0.011 -0.11  -0.065  0.051 -0.13   0.349  0.853 -0.246 -0.122  0.2   -0.    -0.     0.    -0.002  0.    -0.    -0.    -0.   ]
 [ 0.     0.012  0.259  0.185  0.706  0.183 -0.319  0.288  0.413 -0.082 -0.071 -0.    -0.     0.    -0.002  0.    -0.    -0.     0.   ]
 [ 0.     0.013 -0.267  0.073  0.401  0.269  0.764 -0.296  0.133 -0.001  0.04  -0.    -0.     0.    -0.003  0.    -0.    -0.     0.   ]
 [ 0.     0.015 -0.252 -0.573 -0.078  0.734 -0.212  0.109 -0.002  0.009  0.079 -0.    -0.     0.    -0.004  0.    -0.    -0.     0.   ]
 [ 0.     0.014  0.188 -0.663  0.466 -0.361  0.004 -0.192 -0.352 -0.051 -0.119 -0.    -0.     0.    -0.004  0.    -0.    -0.     0.   ]
 [ 0.     0.596 -0.002  0.009 -0.016 -0.012 -0.006 -0.006  0.008 -0.     0.004 -0.067 -0.058  0.094 -0.613  0.074 -0.172 -0.223  0.408]
 [ 0.     0.474 -0.001  0.005 -0.01  -0.008 -0.004 -0.004  0.005 -0.     0.003 -0.162  0.06   0.096 -0.116  0.072  0.101  0.074 -0.838]
 [ 0.     0.378 -0.001  0.003 -0.007 -0.006 -0.003 -0.003  0.004 -0.     0.002  0.459  0.23  -0.215  0.115 -0.353 -0.164  0.609  0.105]
 [ 0.     0.31  -0.001  0.002 -0.005 -0.004 -0.002 -0.002  0.003 -0.     0.001 -0.076 -0.123 -0.525  0.241  0.404  0.588  0.039  0.197]
 [ 0.     0.259 -0.001  0.002 -0.004 -0.003 -0.002 -0.002  0.002 -0.     0.001 -0.1   -0.345 -0.052  0.327 -0.712  0.111 -0.418  0.006]
 [ 0.     0.218 -0.     0.001 -0.003 -0.002 -0.001 -0.001  0.002 -0.     0.001  0.441  0.344  0.567  0.351  0.189  0.235 -0.308  0.097]
 [ 0.     0.182 -0.     0.001 -0.002 -0.002 -0.001 -0.001  0.001 -0.     0.001 -0.533 -0.216  0.476  0.356  0.092 -0.101  0.458  0.232]
 [ 0.     0.147 -0.     0.001 -0.002 -0.001 -0.001 -0.001  0.001 -0.     0.     0.264 -0.407 -0.17   0.337  0.389 -0.633 -0.184 -0.122]
 [ 0.     0.103 -0.     0.    -0.001 -0.001 -0.    -0.001  0.001 -0.     0.    -0.441  0.689 -0.282  0.262 -0.003 -0.33  -0.243  0.063]]
DEBUG: C2 = 
[[ 1.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.]
 [ 0. -1.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.]
 [ 0.  0.  1.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.]
 [ 0.  0.  0.  1.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.]
 [ 0.  0.  0.  0.  1.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.]
 [ 0.  0.  0.  0.  0.  1.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.]
 [ 0.  0.  0.  0.  0.  0.  1.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.]
 [ 0.  0.  0.  0.  0.  0.  0.  1.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.]
 [ 0.  0.  0.  0.  0.  0.  0.  0.  1.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.]
 [ 0.  0.  0.  0.  0.  0.  0.  0.  0.  1.  0.  0.  0.  0.  0.  0.  0.  0.  0.]
 [ 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  1.  0.  0.  0.  0.  0.  0.  0.  0.]
 [ 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  1.  0.  0.  0.  0.  0.  0.  0.]
 [ 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  1.  0.  0.  0.  0.  0.  0.]
 [ 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  1.  0.  0.  0.  0.  0.]
 [ 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  1.  0.  0.  0.  0.]
 [ 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  1.  0.  0.  0.]
 [ 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  1.  0.  0.]
 [ 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  1.  0.]
 [ 0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  0.  1.]]
DEBUG: C3 = 
[[-0.969  0.246  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [-0.246 -0.969  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     1.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     1.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     1.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     1.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     1.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     1.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     1.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     1.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     1.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     1.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     1.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     1.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     1.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     1.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     1.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     1.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     1.   ]]
DEBUG: C4 = 
[[ 1.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     1.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.    -0.15   0.211  0.12  -0.425 -0.186  0.067 -0.575  0.605  0.048  0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.082  0.697  0.463  0.238  0.218 -0.379 -0.098 -0.142  0.128  0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.    -0.559 -0.3   -0.115  0.2   -0.149 -0.681 -0.126  0.023  0.203  0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.    -0.524 -0.045  0.087  0.198  0.668  0.401  0.034  0.188  0.182  0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.    -0.254 -0.121  0.248  0.112 -0.055  0.164 -0.503 -0.457 -0.596  0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.    -0.336  0.096  0.446  0.148 -0.49   0.154  0.531  0.253 -0.217  0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.403 -0.398  0.332  0.583 -0.122  0.12  -0.279  0.247  0.247  0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.    -0.101  0.439 -0.606  0.532 -0.263  0.222 -0.146  0.076 -0.046  0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.185 -0.056 -0.116  0.161  0.349 -0.335  0.095  0.489 -0.664  0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.    -0.05  -0.355 -0.112 -0.073 -0.306  0.046 -0.761 -0.423]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.01   0.132  0.468  0.299  0.454  0.587 -0.125 -0.328]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.035  0.173 -0.553 -0.594  0.413  0.364 -0.086 -0.006]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.986 -0.157  0.04  -0.021  0.012 -0.009 -0.004  0.007]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.056  0.335  0.037 -0.243 -0.263 -0.128  0.383 -0.77 ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.    -0.098 -0.714 -0.299  0.208  0.309 -0.026  0.404 -0.298]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.    -0.065 -0.354  0.282 -0.384 -0.458  0.566  0.283  0.179]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.08   0.232 -0.539  0.55  -0.394  0.428  0.089  0.015]]
DEBUG: C_total = 
[[-0.969  0.246  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.001  0.005 -0.255  0.445 -0.527  0.493 -0.377  0.238 -0.121  0.048 -0.013 -0.001  0.    -0.     0.    -0.     0.    -0.     0.   ]
 [ 0.002  0.007 -0.325  0.424 -0.234 -0.118  0.413 -0.505  0.404 -0.226  0.08  -0.001  0.    -0.     0.    -0.     0.    -0.     0.   ]
 [ 0.002  0.008 -0.356  0.308  0.086 -0.392  0.281  0.137 -0.472  0.481 -0.256 -0.001  0.    -0.     0.    -0.     0.    -0.     0.   ]
 [ 0.002  0.009 -0.371  0.158  0.302 -0.297 -0.176  0.412 -0.039 -0.464  0.491 -0.002  0.    -0.     0.    -0.     0.    -0.     0.   ]
 [ 0.003  0.011 -0.374 -0.005  0.375  0.005 -0.394 -0.004  0.441  0.003 -0.608 -0.002  0.    -0.     0.    -0.     0.    -0.     0.   ]
 [ 0.003  0.012 -0.369 -0.167  0.296  0.303 -0.168 -0.413 -0.047  0.46   0.494 -0.002  0.001 -0.     0.    -0.     0.    -0.     0.   ]
 [ 0.003  0.013 -0.352 -0.314  0.076  0.39   0.287 -0.129 -0.469 -0.483 -0.258 -0.003  0.001 -0.     0.    -0.     0.    -0.     0.   ]
 [ 0.004  0.014 -0.32  -0.426 -0.242  0.109  0.408  0.505  0.407  0.228  0.081 -0.004  0.001 -0.     0.    -0.     0.    -0.     0.   ]
 [ 0.003  0.014 -0.249 -0.441 -0.526 -0.495 -0.381 -0.241 -0.124 -0.049 -0.013 -0.004  0.001 -0.     0.    -0.     0.    -0.     0.   ]
 [ 0.146  0.578  0.023  0.008  0.003  0.001  0.     0.     0.     0.     0.    -0.531  0.45  -0.325  0.201 -0.106  0.046 -0.016  0.004]
 [ 0.116  0.459  0.016  0.005  0.001  0.     0.     0.     0.     0.     0.    -0.18  -0.168  0.433 -0.511  0.424 -0.265  0.123 -0.037]
 [ 0.093  0.367  0.011  0.003  0.001  0.     0.     0.     0.     0.     0.     0.05  -0.38   0.331  0.036 -0.402  0.516 -0.38   0.164]
 [ 0.076  0.301  0.008  0.002  0.     0.     0.     0.     0.     0.     0.     0.2   -0.371 -0.005  0.393 -0.266 -0.23   0.537 -0.399]
 [ 0.064  0.251  0.006  0.001  0.     0.     0.     0.     0.     0.     0.     0.3   -0.239 -0.29   0.287  0.267 -0.376 -0.223  0.598]
 [ 0.054  0.211  0.005  0.001  0.     0.     0.     0.     0.     0.     0.     0.363 -0.041 -0.39  -0.099  0.386  0.262 -0.34  -0.569]
 [ 0.045  0.176  0.004  0.001  0.     0.     0.     0.     0.     0.     0.     0.396  0.182 -0.253 -0.408 -0.091  0.368  0.535  0.341]
 [ 0.036  0.142  0.003  0.     0.     0.     0.     0.     0.     0.     0.     0.395  0.39   0.105 -0.269 -0.497 -0.481 -0.307 -0.121]
 [ 0.025  0.1    0.002  0.     0.     0.     0.     0.     0.     0.     0.     0.331  0.493  0.535  0.46   0.32   0.177  0.075  0.021]]
DEBUG: C_total_restored = 
[[ 1.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [-0.    -0.005 -0.255  0.445 -0.527  0.493 -0.377  0.238 -0.121  0.048 -0.013 -0.001  0.    -0.     0.    -0.     0.    -0.     0.   ]
 [ 0.    -0.007 -0.325  0.424 -0.234 -0.118  0.413 -0.505  0.404 -0.226  0.08  -0.001  0.    -0.     0.    -0.     0.    -0.     0.   ]
 [ 0.    -0.008 -0.356  0.308  0.086 -0.392  0.281  0.137 -0.472  0.481 -0.256 -0.001  0.    -0.     0.    -0.     0.    -0.     0.   ]
 [ 0.    -0.01  -0.371  0.158  0.302 -0.297 -0.176  0.412 -0.039 -0.464  0.491 -0.002  0.    -0.     0.    -0.     0.    -0.     0.   ]
 [-0.    -0.011 -0.374 -0.005  0.375  0.005 -0.394 -0.004  0.441  0.003 -0.608 -0.002  0.    -0.     0.    -0.     0.    -0.     0.   ]
 [-0.    -0.012 -0.369 -0.167  0.296  0.303 -0.168 -0.413 -0.047  0.46   0.494 -0.002  0.001 -0.     0.    -0.     0.    -0.     0.   ]
 [-0.    -0.013 -0.352 -0.314  0.076  0.39   0.287 -0.129 -0.469 -0.483 -0.258 -0.003  0.001 -0.     0.    -0.     0.    -0.     0.   ]
 [ 0.    -0.015 -0.32  -0.426 -0.242  0.109  0.408  0.505  0.407  0.228  0.081 -0.004  0.001 -0.     0.    -0.     0.    -0.     0.   ]
 [ 0.    -0.014 -0.249 -0.441 -0.526 -0.495 -0.381 -0.241 -0.124 -0.049 -0.013 -0.004  0.001 -0.     0.    -0.     0.    -0.     0.   ]
 [ 0.    -0.596  0.023  0.008  0.003  0.001  0.     0.     0.     0.     0.    -0.531  0.45  -0.325  0.201 -0.106  0.046 -0.016  0.004]
 [-0.    -0.474  0.016  0.005  0.001  0.     0.     0.     0.     0.     0.    -0.18  -0.168  0.433 -0.511  0.424 -0.265  0.123 -0.037]
 [ 0.    -0.378  0.011  0.003  0.001  0.     0.     0.     0.     0.     0.     0.05  -0.38   0.331  0.036 -0.402  0.516 -0.38   0.164]
 [-0.    -0.31   0.008  0.002  0.     0.     0.     0.     0.     0.     0.     0.2   -0.371 -0.005  0.393 -0.266 -0.23   0.537 -0.399]
 [-0.    -0.259  0.006  0.001  0.     0.     0.     0.     0.     0.     0.     0.3   -0.239 -0.29   0.287  0.267 -0.376 -0.223  0.598]
 [-0.    -0.218  0.005  0.001  0.     0.     0.     0.     0.     0.     0.     0.363 -0.041 -0.39  -0.099  0.386  0.262 -0.34  -0.569]
 [ 0.    -0.182  0.004  0.001  0.     0.     0.     0.     0.     0.     0.     0.396  0.182 -0.253 -0.408 -0.091  0.368  0.535  0.341]
 [-0.    -0.147  0.003  0.     0.     0.     0.     0.     0.     0.     0.     0.395  0.39   0.105 -0.269 -0.497 -0.481 -0.307 -0.121]
 [-0.    -0.103  0.002  0.     0.     0.     0.     0.     0.     0.     0.     0.331  0.493  0.535  0.46   0.32   0.177  0.075  0.021]]
h_block_final:
[[ 0.    -0.202 -0.219 -0.     0.    -0.     0.    -0.     0.     0.    -0.     0.11   0.     0.    -0.     0.     0.    -0.     0.   ]
 [-0.202  0.746 -0.056  0.    -0.     0.    -0.     0.    -0.    -0.     0.    -0.435  0.     0.    -0.     0.    -0.    -0.     0.   ]
 [-0.219 -0.056 -1.255  0.506 -0.    -0.     0.     0.     0.     0.    -0.     0.     0.    -0.     0.    -0.    -0.    -0.    -0.   ]
 [-0.     0.     0.506 -1.25   0.505  0.    -0.     0.    -0.    -0.    -0.    -0.     0.     0.    -0.     0.     0.    -0.     0.   ]
 [ 0.    -0.     0.     0.505 -1.25   0.494  0.     0.     0.     0.    -0.     0.    -0.     0.     0.     0.     0.    -0.     0.   ]
 [-0.     0.     0.     0.     0.494 -1.249  0.471 -0.     0.    -0.     0.    -0.    -0.    -0.    -0.     0.    -0.     0.    -0.   ]
 [ 0.    -0.     0.    -0.     0.     0.471 -1.249  0.436  0.    -0.    -0.    -0.     0.     0.     0.    -0.     0.     0.    -0.   ]
 [-0.     0.     0.     0.    -0.    -0.     0.436 -1.249  0.389  0.     0.     0.    -0.    -0.    -0.     0.     0.     0.    -0.   ]
 [ 0.    -0.     0.    -0.     0.     0.    -0.     0.389 -1.249  0.326 -0.    -0.     0.     0.     0.    -0.     0.     0.    -0.   ]
 [ 0.    -0.     0.    -0.     0.    -0.    -0.     0.     0.326 -1.249  0.237  0.    -0.     0.     0.    -0.    -0.    -0.    -0.   ]
 [-0.     0.    -0.    -0.    -0.     0.    -0.     0.     0.     0.237 -1.249 -0.     0.    -0.    -0.    -0.    -0.     0.     0.   ]
 [ 0.11  -0.435  0.    -0.     0.    -0.    -0.     0.    -0.     0.    -0.     1.268  0.493  0.     0.     0.     0.     0.    -0.   ]
 [ 0.     0.     0.     0.    -0.    -0.     0.    -0.     0.    -0.     0.     0.493  1.288  0.479 -0.    -0.     0.    -0.    -0.   ]
 [ 0.     0.    -0.     0.     0.    -0.     0.    -0.     0.     0.    -0.     0.     0.479  1.306  0.455 -0.     0.     0.     0.   ]
 [-0.    -0.     0.    -0.     0.    -0.     0.    -0.     0.     0.    -0.     0.    -0.     0.455  1.318  0.421  0.    -0.     0.   ]
 [ 0.     0.    -0.     0.     0.     0.    -0.     0.    -0.    -0.    -0.     0.    -0.    -0.     0.421  1.325  0.375  0.    -0.   ]
 [ 0.    -0.    -0.     0.     0.    -0.     0.     0.     0.    -0.    -0.     0.     0.     0.    -0.     0.375  1.329  0.315 -0.   ]
 [-0.    -0.    -0.    -0.    -0.     0.     0.     0.     0.    -0.     0.     0.    -0.     0.    -0.     0.     0.315  1.332  0.229]
 [ 0.     0.    -0.     0.     0.    -0.    -0.    -0.    -0.    -0.     0.    -0.    -0.     0.    -0.    -0.    -0.     0.229  1.335]]
C_block:
[[ 1.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [-0.    -0.005 -0.255  0.445 -0.527  0.493 -0.377  0.238 -0.121  0.048 -0.013 -0.001  0.    -0.     0.    -0.     0.    -0.     0.   ]
 [ 0.    -0.007 -0.325  0.424 -0.234 -0.118  0.413 -0.505  0.404 -0.226  0.08  -0.001  0.    -0.     0.    -0.     0.    -0.     0.   ]
 [ 0.    -0.008 -0.356  0.308  0.086 -0.392  0.281  0.137 -0.472  0.481 -0.256 -0.001  0.    -0.     0.    -0.     0.    -0.     0.   ]
 [ 0.    -0.01  -0.371  0.158  0.302 -0.297 -0.176  0.412 -0.039 -0.464  0.491 -0.002  0.    -0.     0.    -0.     0.    -0.     0.   ]
 [-0.    -0.011 -0.374 -0.005  0.375  0.005 -0.394 -0.004  0.441  0.003 -0.608 -0.002  0.    -0.     0.    -0.     0.    -0.     0.   ]
 [-0.    -0.012 -0.369 -0.167  0.296  0.303 -0.168 -0.413 -0.047  0.46   0.494 -0.002  0.001 -0.     0.    -0.     0.    -0.     0.   ]
 [-0.    -0.013 -0.352 -0.314  0.076  0.39   0.287 -0.129 -0.469 -0.483 -0.258 -0.003  0.001 -0.     0.    -0.     0.    -0.     0.   ]
 [ 0.    -0.015 -0.32  -0.426 -0.242  0.109  0.408  0.505  0.407  0.228  0.081 -0.004  0.001 -0.     0.    -0.     0.    -0.     0.   ]
 [ 0.    -0.014 -0.249 -0.441 -0.526 -0.495 -0.381 -0.241 -0.124 -0.049 -0.013 -0.004  0.001 -0.     0.    -0.     0.    -0.     0.   ]
 [ 0.    -0.596  0.023  0.008  0.003  0.001  0.     0.     0.     0.     0.    -0.531  0.45  -0.325  0.201 -0.106  0.046 -0.016  0.004]
 [-0.    -0.474  0.016  0.005  0.001  0.     0.     0.     0.     0.     0.    -0.18  -0.168  0.433 -0.511  0.424 -0.265  0.123 -0.037]
 [ 0.    -0.378  0.011  0.003  0.001  0.     0.     0.     0.     0.     0.     0.05  -0.38   0.331  0.036 -0.402  0.516 -0.38   0.164]
 [-0.    -0.31   0.008  0.002  0.     0.     0.     0.     0.     0.     0.     0.2   -0.371 -0.005  0.393 -0.266 -0.23   0.537 -0.399]
 [-0.    -0.259  0.006  0.001  0.     0.     0.     0.     0.     0.     0.     0.3   -0.239 -0.29   0.287  0.267 -0.376 -0.223  0.598]
 [-0.    -0.218  0.005  0.001  0.     0.     0.     0.     0.     0.     0.     0.363 -0.041 -0.39  -0.099  0.386  0.262 -0.34  -0.569]
 [ 0.    -0.182  0.004  0.001  0.     0.     0.     0.     0.     0.     0.     0.396  0.182 -0.253 -0.408 -0.091  0.368  0.535  0.341]
 [-0.    -0.147  0.003  0.     0.     0.     0.     0.     0.     0.     0.     0.395  0.39   0.105 -0.269 -0.497 -0.481 -0.307 -0.121]
 [-0.    -0.103  0.002  0.     0.     0.     0.     0.     0.     0.     0.     0.331  0.493  0.535  0.46   0.32   0.177  0.075  0.021]]
[sanity] ||h_final - C^† h C|| / ||h|| = 0.000e+00
hdc_ab = 
[[ 0.     0.    -0.202 ...  0.     0.     0.   ]
 [ 0.     0.     0.    ... -0.     0.     0.   ]
 [-0.202  0.     0.746 ...  0.     0.     0.   ]
 ...
 [ 0.    -0.     0.    ...  1.332  0.     0.229]
 [ 0.     0.     0.    ...  0.     1.335  0.   ]
 [ 0.     0.     0.    ...  0.229  0.     1.335]]
C_ab = 
[[ 1.     0.     0.    ...  0.     0.     0.   ]
 [ 0.     1.     0.    ...  0.     0.     0.   ]
 [-0.     0.    -0.005 ...  0.     0.     0.   ]
 ...
 [ 0.    -0.     0.    ... -0.307  0.    -0.121]
 [-0.     0.    -0.103 ...  0.     0.021  0.   ]
 [ 0.    -0.     0.    ...  0.075  0.     0.021]]
C = 
[[ 1.     0.     0.    ...  0.     0.     0.   ]
 [-0.    -0.005 -0.255 ...  0.     0.     0.   ]
 [ 0.    -0.007 -0.325 ...  0.     0.     0.   ]
 ...
 [ 0.     0.     0.    ...  0.368  0.535  0.341]
 [ 0.     0.     0.    ... -0.481 -0.307 -0.121]
 [ 0.     0.     0.    ...  0.177  0.075  0.021]]
******************************************
h0_0 = 
[[-0.25  -0.202 -0.219 ...  0.     0.     0.   ]
 [-0.202  0.746 -0.056 ...  0.     0.     0.   ]
 [-0.219 -0.056 -1.255 ...  0.     0.     0.   ]
 ...
 [ 0.     0.     0.    ...  1.329  0.315 -0.   ]
 [ 0.     0.     0.    ...  0.315  1.332  0.229]
 [ 0.     0.     0.    ... -0.     0.229  1.335]]
h0_legacy = 
[[-0.25   0.057  0.073 ...  0.     0.     0.   ]
 [ 0.057 -2.139  0.    ...  0.     0.     0.   ]
 [ 0.073  0.    -1.917 ...  0.     0.     0.   ]
 ...
 [ 0.     0.     0.    ...  1.694  0.     0.   ]
 [ 0.     0.     0.    ...  0.     1.917  0.   ]
 [ 0.     0.     0.    ...  0.     0.     2.139]]
Partitioning system: 1 impurity orbitals, 18 bath orbitals.
Generating basis for 1 electrons on impurity and 18 on bath.
Found 2 impurity configurations and 1 bath configurations.
Generated a total of 2 unique starting determinants.
sb = [<SlaterDeterminant α=[2, 3, 4, 5, 6, 7, 8, 9, 10] β=[0, 2, 3, 4, 5, 6, 7, 8, 9, 10]>, <SlaterDeterminant α=[0, 2, 3, 4, 5, 6, 7, 8, 9, 10] β=[2, 3, 4, 5, 6, 7, 8, 9, 10]>]
DEBUG: build ham time = 0.011166095733642578
[init] dim=2  E0=-22.746491450235
blocks = [-0.5, 0.5], time block = 2.7894973754882812e-05
apply_ham time = 4.982948303222656e-05
gen basis time = 9.393692016601562e-05
sel basis time = 5.507469177246094e-05
Found 2 S_z blocks: [-0.5, 0.5]
  Processing Sz=-0.5 block of size 6x6
DEBUG: build ham time = 0.010754823684692383
  Processing Sz=0.5 block of size 6x6
DEBUG: build ham time = 0.010715007781982422
DEBUG: finished rearranging vectors
DEBUG: for basis size 12, ham diag time = 0.021930932998657227
[iter 0] dim=    12  Es=[-22.819317955270 -22.819317955270]  |dE0|=7.283e-02
blocks = [-0.5, 0.5], time block = 1.9073486328125e-05
apply_ham time = 0.00010919570922851562
gen basis time = 0.0001728534698486328
sel basis time = 9.608268737792969e-05
Found 2 S_z blocks: [-0.5, 0.5]
  Processing Sz=-0.5 block of size 19x19
DEBUG: build ham time = 0.01070094108581543
  Processing Sz=0.5 block of size 19x19
DEBUG: build ham time = 0.011960983276367188
DEBUG: finished rearranging vectors
DEBUG: for basis size 38, ham diag time = 0.023128986358642578
[iter 1] dim=    38  Es=[-22.826131261364 -22.826131261364]  |dE0|=6.813e-03
blocks = [-0.5, 0.5], time block = 4.100799560546875e-05
apply_ham time = 0.0002808570861816406
gen basis time = 0.00041294097900390625
sel basis time = 0.0001780986785888672
Found 2 S_z blocks: [-0.5, 0.5]
  Processing Sz=-0.5 block of size 47x47
DEBUG: build ham time = 0.011322021484375
  Processing Sz=0.5 block of size 47x47
DEBUG: build ham time = 0.011013031005859375
DEBUG: finished rearranging vectors
DEBUG: for basis size 94, ham diag time = 0.023579835891723633
[iter 2] dim=    94  Es=[-22.827288717639 -22.827288717639]  |dE0|=1.157e-03
blocks = [-0.5, 0.5], time block = 9.131431579589844e-05
apply_ham time = 0.0007050037384033203
gen basis time = 0.0009779930114746094
sel basis time = 0.000347137451171875
Found 2 S_z blocks: [-0.5, 0.5]
  Processing Sz=-0.5 block of size 104x104
DEBUG: build ham time = 0.012012958526611328
  Processing Sz=0.5 block of size 104x104
DEBUG: build ham time = 0.01138615608215332
DEBUG: finished rearranging vectors
DEBUG: for basis size 208, ham diag time = 0.15880799293518066
[iter 3] dim=   208  Es=[-22.827487589625 -22.827487589625]  |dE0|=1.989e-04
blocks = [-0.5, 0.5], time block = 0.00020694732666015625
apply_ham time = 0.0016398429870605469
gen basis time = 0.002235889434814453
sel basis time = 0.0006880760192871094
Found 2 S_z blocks: [-0.5, 0.5]
  Processing Sz=-0.5 block of size 202x202
DEBUG: build ham time = 0.011705875396728516
  Processing Sz=0.5 block of size 202x202
DEBUG: build ham time = 0.01154017448425293
DEBUG: finished rearranging vectors
DEBUG: for basis size 404, ham diag time = 0.30310678482055664
[iter 4] dim=   404  Es=[-22.827519142088 -22.827519142088]  |dE0|=3.155e-05
blocks = [-0.5, 0.5], time block = 0.00039386749267578125
apply_ham time = 0.003420114517211914
gen basis time = 0.004604816436767578
sel basis time = 0.0013201236724853516
Found 2 S_z blocks: [-0.5, 0.5]
  Processing Sz=-0.5 block of size 348x348
DEBUG: build ham time = 0.01291203498840332
  Processing Sz=0.5 block of size 348x348
DEBUG: build ham time = 0.012094974517822266
DEBUG: finished rearranging vectors
DEBUG: for basis size 696, ham diag time = 0.185380220413208
[iter 5] dim=   696  Es=[-22.827523492535 -22.827523492535]  |dE0|=4.350e-06
[conv] reached |dE| < 1e-05
Found 2 S_z blocks: [-0.5, 0.5]
  Processing Sz=-0.5 block of size 348x348
DEBUG: build ham time = 0.012104988098144531
  Processing Sz=0.5 block of size 348x348
DEBUG: build ham time = 0.012015819549560547
DEBUG: finished rearranging vectors
sci total time : 1.2097389698028564
energies = [-22.828 -22.828], e0 = -22.827523492535228
len basis = 696
len(basis(psis0)) = 696
target_indices = [0, 19]
 Founds blocks : [[0], [1]]
  Symmetry: is_diagonal=True. Found 1 unique group(s) of blocks.
  Computing representative g_(0,0) via Scalar CF...
DEBUG: build ham time = 0.01332998275756836
DEBUG: build ham time = 0.011871814727783203
target_indices = [0, 19]
 Founds blocks : [[0], [1]]
  Symmetry: is_diagonal=True. Found 1 unique group(s) of blocks.
  Computing representative g_(0,0) via Scalar CF...
DEBUG: build ham time = 0.01277613639831543
DEBUG: build ham time = 0.012404918670654297
rdm : 
[[0.5+0.j 0. +0.j]
 [0. +0.j 0.5+0.j]]
impurity occupation: (0.9999965911610711+0j)
total occupation : (0.9999965911610711+0j)

Thermally-averaged calculation finished.
Data saved to 'dump/A_18'
