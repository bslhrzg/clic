******************************************
******************************************
NF = 76, M = 38, Nimp = 2
******************************************
[[-0.75   0.     0.    ...  0.     0.     0.   ]
 [ 0.    -0.75   0.    ...  0.     0.     0.   ]
 [ 0.     0.    -0.75  ...  0.     0.057  0.   ]
 ...
 [ 0.     0.     0.    ...  1.917  0.     0.   ]
 [ 0.     0.     0.057 ...  0.     2.139  0.   ]
 [ 0.     0.     0.    ...  0.     0.     2.139]]
************
[[-0.75   0.     0.057 ...  0.     0.     0.   ]
 [ 0.    -0.75   0.    ...  0.08   0.073  0.057]
 [ 0.057  0.    -2.139 ...  0.     0.     0.   ]
 ...
 [ 0.     0.08   0.    ...  1.694  0.     0.   ]
 [ 0.     0.073  0.    ...  0.     1.917  0.   ]
 [ 0.     0.057  0.    ...  0.     0.     2.139]]
h0_0 size:  (76, 76)
U_0 size:  (76, 76, 76, 76)
Going with Nelec_imp = 2, nbath = 36, Nelec = 38
imp_indices_full = [0, 1, 38, 39]
h0_0 = 
[[-0.75   0.     0.057 ...  0.     0.     0.   ]
 [ 0.    -0.75   0.    ...  0.     0.     0.   ]
 [ 0.057  0.    -2.139 ...  0.     0.     0.   ]
 ...
 [ 0.     0.     0.    ...  1.694  0.     0.   ]
 [ 0.     0.     0.    ...  0.     1.917  0.   ]
 [ 0.     0.     0.    ...  0.     0.     2.139]]


--------------------------------------------------------------
Mean-Field Self-Consistent Procedure with block handling
--------------------------------------------------------------
[V1] mfscf proc with Ne=38, maxiter=100, alpha=0.2, threshold=1e-07, spinsym_only = False
[V1] Symmetry analysis found 4 blocks.
[V1] Found 1 unique groups of blocks.
[V1] Blocks: [[0, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19], [1, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37], [38, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57], [39, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75]]
[V1] Identical Groups (by block index): [[0, 1, 2, 3]]
[V1] iter 0, Tr(rho*h0) = -42.21861061
[V1] Ne = 38, initial tr(rho) = 38.00000000+0.00000000j
[V1] mixing parameter: α = 0.2
[V2] Number of non-zero U elements: 16
[V1] Iter         E_total          E_corr        ΔE_total
[V2] U is sparse, using nzU
[V1]    1    -39.61504802     -2.60356259      1.0396e+03
[V1]   10    -41.06896103     -0.40221700      3.0212e-02
[V1]   20    -41.17308568     -0.35364123      3.1023e-03
[V1]   30    -41.18416200     -0.35316433      3.3309e-04
[V1]   40    -41.18535130     -0.35315999      3.5765e-05
[V1]   50    -41.18547900     -0.35315995      3.8403e-06
[V1]   60    -41.18549271     -0.35315995      4.1238e-07
[V1] Converged in 67 iterations.
[V1] Final tr(rho) = 38.00000000+0.00000000j
[V2] Reordering final eigenvectors to spin-blocked convention...
hmf = 
[[-0.235  0.     0.057 ...  0.     0.     0.   ]
 [ 0.    -0.235  0.    ...  0.     0.     0.   ]
 [ 0.057  0.    -2.139 ...  0.     0.     0.   ]
 ...
 [ 0.     0.     0.    ...  1.694  0.     0.   ]
 [ 0.     0.     0.    ...  0.     1.917  0.   ]
 [ 0.     0.     0.    ...  0.     0.     2.139]]
DEBUG, Nimp_sf = 4
hmf_ab = 
[[-0.235+0.j  0.   +0.j  0.   +0.j ...  0.   +0.j  0.   +0.j  0.   +0.j]
 [ 0.   +0.j -0.235+0.j  0.   +0.j ...  0.   +0.j  0.   +0.j  0.   +0.j]
 [ 0.   +0.j  0.   +0.j -0.235+0.j ...  0.   +0.j  0.057+0.j  0.   +0.j]
 ...
 [ 0.   +0.j  0.   +0.j  0.   +0.j ...  1.917+0.j  0.   +0.j  0.   +0.j]
 [ 0.   +0.j  0.   +0.j  0.057+0.j ...  0.   +0.j  2.139+0.j  0.   +0.j]
 [ 0.   +0.j  0.   +0.j  0.   +0.j ...  0.   +0.j  0.   +0.j  2.139+0.j]]

--- Analyzed Structure ---
Found 4 blocks
Blocks: [[0, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38], [1, 5, 7, 9, 11, 13, 15, 17, 19, 21, 23, 25, 27, 29, 31, 33, 35, 37, 39], [2, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74], [3, 41, 43, 45, 47, 49, 51, 53, 55, 57, 59, 61, 63, 65, 67, 69, 71, 73, 75]]
Identical Groups (by block index): [[0, 1, 2, 3]]
[blocks] 4 blocks; identical groups: [[0, 1, 2, 3]]
[check] Tr rho = 37.999999999912, sum blocks = 36.000000000000, Nelec = 38
[leader block 0] size=19 Nimp_b=1 Nelec_b=9
DEBUG: C1 = 
[[ 1.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.    -0.066 -0.371  0.032  0.186 -0.833  0.342 -0.018 -0.013  0.108 -0.     0.    -0.001  0.    -0.001  0.    -0.     0.     0.001]
 [ 0.    -0.094 -0.03  -0.104  0.479  0.07  -0.046 -0.592  0.551 -0.297 -0.     0.    -0.001  0.    -0.002  0.    -0.     0.001  0.001]
 [ 0.    -0.119 -0.144  0.254  0.111  0.026 -0.211 -0.529 -0.738 -0.137 -0.     0.    -0.001 -0.    -0.003  0.    -0.     0.001  0.002]
 [ 0.    -0.145 -0.229 -0.083  0.384  0.139 -0.38   0.047  0.033  0.778 -0.     0.    -0.002 -0.    -0.004  0.    -0.     0.001  0.003]
 [ 0.    -0.178 -0.256 -0.085  0.361 -0.044 -0.415  0.559 -0.083 -0.521 -0.     0.001 -0.002 -0.    -0.006  0.    -0.     0.002  0.004]
 [ 0.    -0.222 -0.716  0.368 -0.295  0.358  0.201  0.014  0.211 -0.044 -0.     0.001 -0.003 -0.    -0.008  0.    -0.     0.002  0.005]
 [ 0.    -0.291  0.371  0.76  -0.033 -0.234 -0.277  0.067  0.246  0.044 -0.001  0.001 -0.005 -0.    -0.011 -0.    -0.     0.004  0.008]
 [ 0.    -0.418  0.254  0.095  0.454  0.284  0.624  0.193 -0.193  0.033 -0.001  0.002 -0.007 -0.001 -0.019 -0.001 -0.001  0.006  0.013]
 [ 0.    -0.78   0.087 -0.432 -0.39  -0.126 -0.114 -0.115  0.011  0.    -0.003  0.006 -0.015 -0.002 -0.041 -0.005 -0.002  0.015  0.029]
 [ 0.    -0.028  0.003 -0.004 -0.004 -0.001  0.001 -0.    -0.     0.     0.315 -0.556  0.159  0.02   0.219  0.679  0.122 -0.156 -0.132]
 [ 0.    -0.028  0.003 -0.004 -0.004 -0.     0.001 -0.    -0.     0.    -0.167 -0.031 -0.368  0.101  0.062 -0.097 -0.15  -0.344 -0.819]
 [ 0.    -0.026  0.002 -0.003 -0.003 -0.     0.001  0.    -0.     0.    -0.368  0.435  0.355  0.087  0.298  0.184  0.619 -0.069 -0.173]
 [ 0.    -0.023  0.002 -0.002 -0.002 -0.     0.001  0.    -0.     0.     0.132  0.134 -0.007  0.157  0.549 -0.172 -0.218 -0.653  0.368]
 [ 0.    -0.02   0.001 -0.002 -0.002 -0.     0.001  0.    -0.     0.     0.037  0.077 -0.276 -0.173  0.713  0.034 -0.159  0.588 -0.074]
 [ 0.    -0.018  0.001 -0.001 -0.001 -0.     0.     0.    -0.     0.    -0.016  0.195  0.699 -0.119  0.008  0.079 -0.622  0.054 -0.25 ]
 [ 0.    -0.015  0.001 -0.001 -0.001 -0.     0.     0.    -0.     0.     0.614 -0.052  0.266  0.396  0.079 -0.481  0.247  0.176 -0.249]
 [ 0.    -0.013  0.001 -0.001 -0.001 -0.     0.     0.    -0.     0.    -0.538 -0.659  0.264  0.036  0.197 -0.4    0.032  0.053  0.055]
 [ 0.    -0.009  0.    -0.001 -0.001 -0.     0.     0.    -0.     0.     0.227 -0.042  0.086 -0.869  0.042 -0.261  0.239 -0.21  -0.112]]
DEBUG: C2 = 
[[1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]]
DEBUG: C3 = 
[[ 0.404 -0.915  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.915  0.404  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     1.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     1.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     1.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     1.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     1.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     1.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     1.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     1.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     1.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     1.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     1.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     1.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     1.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     1.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     1.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     1.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     1.   ]]
DEBUG: C4 = 
[[ 1.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     1.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.    -0.532  0.169  0.278  0.495 -0.186 -0.257 -0.454 -0.244  0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.476  0.574  0.303 -0.088 -0.39  -0.399  0.169 -0.069  0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.648 -0.096  0.216  0.451  0.337  0.216 -0.395 -0.066  0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.    -0.052  0.511 -0.408  0.498 -0.132  0.414  0.199  0.305  0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.    -0.219  0.049  0.76   0.058  0.224  0.296  0.426  0.221  0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.    -0.139  0.606 -0.06  -0.382  0.595  0.088 -0.257 -0.19   0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.    -0.     0.044  0.184 -0.371 -0.42   0.382 -0.557  0.441  0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.    -0.021  0.005 -0.044  0.095  0.32  -0.561 -0.111  0.748  0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.    -0.054 -0.085 -0.045  0.336 -0.465 -0.235 -0.46  -0.62  -0.089]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.088  0.188  0.629 -0.505 -0.032 -0.404 -0.363  0.098 -0.032]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.    -0.405 -0.319  0.055  0.285  0.029  0.053 -0.514  0.521  0.334]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.054  0.374  0.401  0.471  0.575  0.246 -0.148 -0.247  0.023]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.    -0.756  0.189  0.261 -0.15  -0.257  0.366  0.183 -0.107 -0.238]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.19   0.707 -0.145  0.243 -0.447  0.061 -0.092  0.414 -0.037]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.011  0.049 -0.406 -0.297  0.273  0.273 -0.535  0.029 -0.554]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.146 -0.334  0.32   0.376 -0.083 -0.109  0.165  0.296 -0.7  ]
 [ 0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.44  -0.258  0.286 -0.134 -0.323  0.703 -0.125 -0.049  0.153]]
DEBUG: C_total = 
[[ 0.404 -0.915  0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [-0.06  -0.026  0.301 -0.482  0.541 -0.476  0.335 -0.188  0.08  -0.023  0.002 -0.     0.    -0.     0.    -0.     0.    -0.     0.   ]
 [-0.086 -0.038  0.372 -0.413  0.15   0.236 -0.491  0.494 -0.321  0.128  0.003 -0.     0.    -0.     0.    -0.     0.    -0.     0.   ]
 [-0.108 -0.048  0.391 -0.239 -0.208  0.42  -0.134 -0.344  0.542 -0.356  0.004 -0.001  0.    -0.     0.    -0.     0.    -0.     0.   ]
 [-0.133 -0.059  0.385 -0.036 -0.383  0.158  0.363 -0.3   -0.313  0.582  0.005 -0.001  0.    -0.     0.    -0.     0.    -0.     0.   ]
 [-0.163 -0.072  0.356  0.163 -0.343 -0.235  0.316  0.346 -0.266 -0.593  0.007 -0.001  0.    -0.     0.    -0.     0.    -0.     0.   ]
 [-0.203 -0.09   0.301  0.329 -0.105 -0.418 -0.206  0.289  0.544  0.38   0.01  -0.002  0.001 -0.     0.    -0.     0.    -0.     0.   ]
 [-0.266 -0.118  0.206  0.42   0.25  -0.144 -0.457 -0.51  -0.351 -0.145  0.014 -0.004  0.001 -0.     0.    -0.     0.    -0.     0.   ]
 [-0.382 -0.169  0.025  0.338  0.507  0.501  0.377  0.222  0.098  0.029  0.024 -0.007  0.002 -0.001  0.    -0.     0.    -0.     0.   ]
 [-0.713 -0.315 -0.458 -0.335 -0.217 -0.124 -0.061 -0.026 -0.008 -0.002  0.052 -0.018  0.006 -0.002  0.001 -0.     0.    -0.     0.   ]
 [-0.026 -0.011 -0.006 -0.002 -0.001 -0.    -0.    -0.    -0.    -0.    -0.245  0.438 -0.526  0.496 -0.383  0.243 -0.125  0.049 -0.013]
 [-0.026 -0.011 -0.006 -0.001 -0.    -0.    -0.    -0.    -0.    -0.    -0.317  0.426 -0.245 -0.105  0.406 -0.505  0.408 -0.23   0.082]
 [-0.024 -0.01  -0.004 -0.001 -0.    -0.    -0.    -0.    -0.    -0.    -0.35   0.316  0.072 -0.388  0.289  0.126 -0.468  0.484 -0.259]
 [-0.021 -0.009 -0.004 -0.001 -0.    -0.    -0.    -0.    -0.    -0.    -0.368  0.17   0.294 -0.305 -0.165  0.413 -0.049 -0.459  0.494]
 [-0.019 -0.008 -0.003 -0.001 -0.    -0.    -0.    -0.    -0.    -0.    -0.374  0.008  0.375 -0.008 -0.393  0.007  0.441 -0.005 -0.608]
 [-0.016 -0.007 -0.002 -0.    -0.    -0.    -0.    -0.    -0.    -0.    -0.371 -0.156  0.303  0.296 -0.178 -0.411 -0.037  0.464  0.491]
 [-0.014 -0.006 -0.002 -0.    -0.    -0.    -0.    -0.    -0.    -0.    -0.357 -0.307  0.088  0.393  0.279 -0.139 -0.472 -0.481 -0.255]
 [-0.012 -0.005 -0.001 -0.    -0.    -0.    -0.    -0.    -0.    -0.    -0.326 -0.424 -0.232  0.12   0.414  0.504  0.403  0.225  0.08 ]
 [-0.008 -0.004 -0.001 -0.    -0.    -0.    -0.    -0.    -0.    -0.    -0.256 -0.446 -0.527 -0.492 -0.377 -0.237 -0.121 -0.048 -0.013]]
DEBUG: C_total_restored = 
[[ 1.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.    -0.066  0.301 -0.482  0.541 -0.476  0.335 -0.188  0.08  -0.023  0.002 -0.     0.    -0.     0.    -0.     0.    -0.     0.   ]
 [ 0.    -0.094  0.372 -0.413  0.15   0.236 -0.491  0.494 -0.321  0.128  0.003 -0.     0.    -0.     0.    -0.     0.    -0.     0.   ]
 [-0.    -0.119  0.391 -0.239 -0.208  0.42  -0.134 -0.344  0.542 -0.356  0.004 -0.001  0.    -0.     0.    -0.     0.    -0.     0.   ]
 [-0.    -0.145  0.385 -0.036 -0.383  0.158  0.363 -0.3   -0.313  0.582  0.005 -0.001  0.    -0.     0.    -0.     0.    -0.     0.   ]
 [-0.    -0.178  0.356  0.163 -0.343 -0.235  0.316  0.346 -0.266 -0.593  0.007 -0.001  0.    -0.     0.    -0.     0.    -0.     0.   ]
 [-0.    -0.222  0.301  0.329 -0.105 -0.418 -0.206  0.289  0.544  0.38   0.01  -0.002  0.001 -0.     0.    -0.     0.    -0.     0.   ]
 [ 0.    -0.291  0.206  0.42   0.25  -0.144 -0.457 -0.51  -0.351 -0.145  0.014 -0.004  0.001 -0.     0.    -0.     0.    -0.     0.   ]
 [-0.    -0.418  0.025  0.338  0.507  0.501  0.377  0.222  0.098  0.029  0.024 -0.007  0.002 -0.001  0.    -0.     0.    -0.     0.   ]
 [-0.    -0.78  -0.458 -0.335 -0.217 -0.124 -0.061 -0.026 -0.008 -0.002  0.052 -0.018  0.006 -0.002  0.001 -0.     0.    -0.     0.   ]
 [ 0.    -0.028 -0.006 -0.002 -0.001 -0.    -0.    -0.    -0.    -0.    -0.245  0.438 -0.526  0.496 -0.383  0.243 -0.125  0.049 -0.013]
 [ 0.    -0.028 -0.006 -0.001 -0.    -0.    -0.    -0.    -0.    -0.    -0.317  0.426 -0.245 -0.105  0.406 -0.505  0.408 -0.23   0.082]
 [-0.    -0.026 -0.004 -0.001 -0.    -0.    -0.    -0.    -0.    -0.    -0.35   0.316  0.072 -0.388  0.289  0.126 -0.468  0.484 -0.259]
 [-0.    -0.023 -0.004 -0.001 -0.    -0.    -0.    -0.    -0.    -0.    -0.368  0.17   0.294 -0.305 -0.165  0.413 -0.049 -0.459  0.494]
 [ 0.    -0.02  -0.003 -0.001 -0.    -0.    -0.    -0.    -0.    -0.    -0.374  0.008  0.375 -0.008 -0.393  0.007  0.441 -0.005 -0.608]
 [-0.    -0.018 -0.002 -0.    -0.    -0.    -0.    -0.    -0.    -0.    -0.371 -0.156  0.303  0.296 -0.178 -0.411 -0.037  0.464  0.491]
 [ 0.    -0.015 -0.002 -0.    -0.    -0.    -0.    -0.    -0.    -0.    -0.357 -0.307  0.088  0.393  0.279 -0.139 -0.472 -0.481 -0.255]
 [ 0.    -0.013 -0.001 -0.    -0.    -0.    -0.    -0.    -0.    -0.    -0.326 -0.424 -0.232  0.12   0.414  0.504  0.403  0.225  0.08 ]
 [ 0.    -0.009 -0.001 -0.    -0.    -0.    -0.    -0.    -0.    -0.    -0.256 -0.446 -0.527 -0.492 -0.377 -0.237 -0.121 -0.048 -0.013]]
h_block_final:
[[-0.235 -0.177  0.152  0.    -0.    -0.    -0.     0.    -0.     0.    -0.216 -0.    -0.    -0.     0.     0.    -0.    -0.    -0.   ]
 [-0.177 -0.557  0.344 -0.     0.    -0.     0.    -0.     0.    -0.     0.096 -0.    -0.    -0.     0.     0.    -0.    -0.    -0.   ]
 [ 0.152  0.344 -1.297  0.479 -0.     0.    -0.    -0.     0.    -0.     0.    -0.    -0.     0.    -0.    -0.    -0.     0.    -0.   ]
 [ 0.    -0.     0.479 -1.317  0.466  0.    -0.     0.     0.     0.    -0.     0.     0.    -0.     0.     0.     0.     0.     0.   ]
 [-0.     0.    -0.     0.466 -1.334  0.444 -0.     0.    -0.    -0.     0.    -0.     0.     0.     0.     0.    -0.     0.    -0.   ]
 [-0.    -0.    -0.     0.     0.444 -1.343  0.412  0.    -0.     0.    -0.     0.    -0.    -0.    -0.    -0.     0.    -0.    -0.   ]
 [-0.     0.    -0.    -0.    -0.     0.412 -1.347  0.369  0.     0.    -0.    -0.     0.     0.    -0.    -0.     0.     0.     0.   ]
 [ 0.    -0.    -0.    -0.     0.     0.     0.369 -1.349  0.31  -0.    -0.     0.     0.    -0.    -0.     0.     0.     0.     0.   ]
 [-0.     0.     0.     0.    -0.     0.     0.     0.31  -1.35   0.226  0.     0.    -0.     0.     0.     0.    -0.    -0.    -0.   ]
 [ 0.    -0.    -0.     0.    -0.     0.     0.    -0.     0.226 -1.351 -0.    -0.    -0.     0.    -0.    -0.     0.     0.    -0.   ]
 [-0.216  0.096  0.    -0.     0.    -0.    -0.    -0.     0.    -0.     1.256  0.506  0.     0.    -0.     0.     0.     0.     0.   ]
 [-0.    -0.    -0.     0.    -0.     0.    -0.     0.     0.    -0.     0.506  1.25   0.505  0.    -0.     0.     0.     0.     0.   ]
 [-0.    -0.    -0.     0.     0.    -0.     0.     0.    -0.    -0.     0.     0.505  1.249  0.495 -0.     0.    -0.     0.     0.   ]
 [-0.    -0.     0.    -0.     0.    -0.     0.    -0.     0.     0.    -0.    -0.     0.495  1.249  0.471 -0.     0.     0.    -0.   ]
 [ 0.     0.    -0.     0.     0.    -0.    -0.    -0.     0.    -0.    -0.    -0.    -0.     0.471  1.248  0.436 -0.    -0.    -0.   ]
 [ 0.     0.    -0.     0.     0.    -0.    -0.     0.     0.    -0.     0.     0.     0.     0.     0.436  1.248  0.389  0.     0.   ]
 [-0.    -0.    -0.     0.    -0.     0.     0.     0.    -0.     0.     0.     0.    -0.     0.    -0.     0.389  1.248  0.326  0.   ]
 [-0.    -0.     0.     0.     0.    -0.     0.     0.    -0.     0.     0.     0.     0.     0.    -0.     0.     0.326  1.248  0.237]
 [-0.    -0.    -0.     0.    -0.    -0.     0.     0.    -0.    -0.     0.     0.    -0.    -0.    -0.     0.     0.     0.237  1.248]]
C_block:
[[ 1.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.     0.   ]
 [ 0.    -0.066  0.301 -0.482  0.541 -0.476  0.335 -0.188  0.08  -0.023  0.002 -0.     0.    -0.     0.    -0.     0.    -0.     0.   ]
 [ 0.    -0.094  0.372 -0.413  0.15   0.236 -0.491  0.494 -0.321  0.128  0.003 -0.     0.    -0.     0.    -0.     0.    -0.     0.   ]
 [-0.    -0.119  0.391 -0.239 -0.208  0.42  -0.134 -0.344  0.542 -0.356  0.004 -0.001  0.    -0.     0.    -0.     0.    -0.     0.   ]
 [-0.    -0.145  0.385 -0.036 -0.383  0.158  0.363 -0.3   -0.313  0.582  0.005 -0.001  0.    -0.     0.    -0.     0.    -0.     0.   ]
 [-0.    -0.178  0.356  0.163 -0.343 -0.235  0.316  0.346 -0.266 -0.593  0.007 -0.001  0.    -0.     0.    -0.     0.    -0.     0.   ]
 [-0.    -0.222  0.301  0.329 -0.105 -0.418 -0.206  0.289  0.544  0.38   0.01  -0.002  0.001 -0.     0.    -0.     0.    -0.     0.   ]
 [ 0.    -0.291  0.206  0.42   0.25  -0.144 -0.457 -0.51  -0.351 -0.145  0.014 -0.004  0.001 -0.     0.    -0.     0.    -0.     0.   ]
 [-0.    -0.418  0.025  0.338  0.507  0.501  0.377  0.222  0.098  0.029  0.024 -0.007  0.002 -0.001  0.    -0.     0.    -0.     0.   ]
 [-0.    -0.78  -0.458 -0.335 -0.217 -0.124 -0.061 -0.026 -0.008 -0.002  0.052 -0.018  0.006 -0.002  0.001 -0.     0.    -0.     0.   ]
 [ 0.    -0.028 -0.006 -0.002 -0.001 -0.    -0.    -0.    -0.    -0.    -0.245  0.438 -0.526  0.496 -0.383  0.243 -0.125  0.049 -0.013]
 [ 0.    -0.028 -0.006 -0.001 -0.    -0.    -0.    -0.    -0.    -0.    -0.317  0.426 -0.245 -0.105  0.406 -0.505  0.408 -0.23   0.082]
 [-0.    -0.026 -0.004 -0.001 -0.    -0.    -0.    -0.    -0.    -0.    -0.35   0.316  0.072 -0.388  0.289  0.126 -0.468  0.484 -0.259]
 [-0.    -0.023 -0.004 -0.001 -0.    -0.    -0.    -0.    -0.    -0.    -0.368  0.17   0.294 -0.305 -0.165  0.413 -0.049 -0.459  0.494]
 [ 0.    -0.02  -0.003 -0.001 -0.    -0.    -0.    -0.    -0.    -0.    -0.374  0.008  0.375 -0.008 -0.393  0.007  0.441 -0.005 -0.608]
 [-0.    -0.018 -0.002 -0.    -0.    -0.    -0.    -0.    -0.    -0.    -0.371 -0.156  0.303  0.296 -0.178 -0.411 -0.037  0.464  0.491]
 [ 0.    -0.015 -0.002 -0.    -0.    -0.    -0.    -0.    -0.    -0.    -0.357 -0.307  0.088  0.393  0.279 -0.139 -0.472 -0.481 -0.255]
 [ 0.    -0.013 -0.001 -0.    -0.    -0.    -0.    -0.    -0.    -0.    -0.326 -0.424 -0.232  0.12   0.414  0.504  0.403  0.225  0.08 ]
 [ 0.    -0.009 -0.001 -0.    -0.    -0.    -0.    -0.    -0.    -0.    -0.256 -0.446 -0.527 -0.492 -0.377 -0.237 -0.121 -0.048 -0.013]]
[sanity] ||h_final - C^† h C|| / ||h|| = 0.000e+00
hdc_ab = 
[[-0.235  0.     0.    ...  0.     0.     0.   ]
 [ 0.    -0.235  0.    ...  0.     0.     0.   ]
 [ 0.     0.    -0.235 ...  0.    -0.     0.   ]
 ...
 [ 0.     0.     0.    ...  1.248  0.     0.237]
 [ 0.     0.    -0.    ...  0.     1.248  0.   ]
 [ 0.     0.     0.    ...  0.237  0.     1.248]]
C_ab = 
[[ 1.     0.     0.    ...  0.     0.     0.   ]
 [ 0.     1.     0.    ...  0.     0.     0.   ]
 [ 0.     0.     1.    ...  0.     0.     0.   ]
 ...
 [ 0.     0.     0.    ...  0.225  0.     0.08 ]
 [ 0.     0.     0.    ...  0.    -0.013  0.   ]
 [ 0.     0.     0.    ... -0.048  0.    -0.013]]
C = 
[[ 1.     0.     0.    ...  0.     0.     0.   ]
 [ 0.     1.     0.    ...  0.     0.     0.   ]
 [ 0.     0.    -0.066 ...  0.     0.     0.   ]
 ...
 [ 0.     0.     0.    ... -0.472 -0.481 -0.255]
 [ 0.     0.     0.    ...  0.403  0.225  0.08 ]
 [ 0.     0.     0.    ... -0.121 -0.048 -0.013]]
******************************************
h0_0 = 
[[-0.75   0.    -0.177 ...  0.     0.     0.   ]
 [ 0.    -0.75   0.    ...  0.     0.     0.   ]
 [-0.177  0.    -0.557 ...  0.     0.     0.   ]
 ...
 [ 0.     0.     0.    ...  1.248  0.326  0.   ]
 [ 0.     0.     0.    ...  0.326  1.248  0.237]
 [ 0.     0.     0.    ...  0.     0.237  1.248]]
h0_legacy = 
[[-0.75   0.     0.057 ...  0.     0.     0.   ]
 [ 0.    -0.75   0.    ...  0.     0.     0.   ]
 [ 0.057  0.    -2.139 ...  0.     0.     0.   ]
 ...
 [ 0.     0.     0.    ...  1.694  0.     0.   ]
 [ 0.     0.     0.    ...  0.     1.917  0.   ]
 [ 0.     0.     0.    ...  0.     0.     2.139]]
Partitioning system: 2 impurity orbitals, 36 bath orbitals.
Generating basis for 2 electrons on impurity and 36 on bath.
Found 2 impurity configurations and 1 bath configurations.
Retaining only Sz=0 in starting basis
Generated a total of 2 unique starting determinants.
sb = [<SlaterDeterminant α=[0, 2, 3, 4, 5, 6, 7, 8, 9, 10, 20, 21, 22, 23, 24, 25, 26, 27, 28] β=[0, 2, 3, 4, 5, 6, 7, 8, 9, 10, 20, 21, 22, 23, 24, 25, 26, 27, 28]>, <SlaterDeterminant α=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 20, 21, 22, 23, 24, 25, 26, 27, 28] β=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 20, 21, 22, 23, 24, 25, 26, 27, 28]>]
DEBUG: build ham time = 0.3528251647949219
[init] dim=2  E0=-45.977139115835
blocks = [0.0], time block = 2.384185791015625e-05
apply_ham time = 8.416175842285156e-05
gen basis time = 0.00013518333435058594
sel basis time = 0.0001957416534423828
Found 1 S_z blocks: [0.0]
  Processing Sz=0.0 block of size 22x22
DEBUG: build ham time = 0.35389208793640137
DEBUG: finished rearranging vectors
DEBUG: for basis size 22, ham diag time = 0.35436201095581055
[iter 0] dim=    22  Es=[-46.127144297140 -46.127144297140]  |dE0|=1.500e-01
blocks = [0.0], time block = 3.0994415283203125e-05
apply_ham time = 0.00045490264892578125
gen basis time = 0.0006170272827148438
sel basis time = 0.0008182525634765625
Found 1 S_z blocks: [0.0]
  Processing Sz=0.0 block of size 124x124
DEBUG: build ham time = 0.3542919158935547
DEBUG: finished rearranging vectors
DEBUG: for basis size 124, ham diag time = 0.3650848865509033
[iter 1] dim=   124  Es=[-46.149867207678 -46.149867207677]  |dE0|=2.272e-02
blocks = [0.0], time block = 0.00016021728515625
apply_ham time = 0.002597808837890625
gen basis time = 0.003256082534790039
sel basis time = 0.0029549598693847656
Found 1 S_z blocks: [0.0]
  Processing Sz=0.0 block of size 494x494
DEBUG: build ham time = 0.3592529296875
DEBUG: finished rearranging vectors
DEBUG: for basis size 494, ham diag time = 0.38828587532043457
[iter 2] dim=   494  Es=[-46.154397684670 -46.154397684642]  |dE0|=4.530e-03
blocks = [0.0], time block = 0.0005998611450195312
apply_ham time = 0.010545969009399414
gen basis time = 0.012566089630126953
sel basis time = 0.008658885955810547
Found 1 S_z blocks: [0.0]
  Processing Sz=0.0 block of size 1482x1482
DEBUG: build ham time = 0.36761999130249023
DEBUG: finished rearranging vectors
DEBUG: for basis size 1482, ham diag time = 0.43176698684692383
[iter 3] dim=  1482  Es=[-46.155356803777 -46.155356800224]  |dE0|=9.591e-04
blocks = [0.0], time block = 0.001730203628540039
apply_ham time = 0.03296399116516113
gen basis time = 0.03898000717163086
sel basis time = 0.023537158966064453
Found 1 S_z blocks: [0.0]
  Processing Sz=0.0 block of size 4248x4248
DEBUG: build ham time = 0.38851308822631836
DEBUG: finished rearranging vectors
DEBUG: for basis size 4248, ham diag time = 1.065526008605957
[iter 4] dim=  4248  Es=[-46.155550360559 -46.155550359683]  |dE0|=1.936e-04
blocks = [0.0], time block = 0.00493168830871582
apply_ham time = 0.0910940170288086
gen basis time = 0.1066739559173584
sel basis time = 0.0579221248626709
Found 1 S_z blocks: [0.0]
  Processing Sz=0.0 block of size 9826x9826
DEBUG: build ham time = 0.4372129440307617
DEBUG: finished rearranging vectors
DEBUG: for basis size 9826, ham diag time = 1.3763058185577393
[iter 5] dim=  9826  Es=[-46.155586422759 -46.155586422695]  |dE0|=3.606e-05
blocks = [0.0], time block = 0.011443853378295898
apply_ham time = 0.21008515357971191
gen basis time = 0.25187206268310547
sel basis time = 0.15254902839660645
Found 1 S_z blocks: [0.0]
  Processing Sz=0.0 block of size 17828x17828
DEBUG: build ham time = 0.5022270679473877
DEBUG: finished rearranging vectors
DEBUG: for basis size 17828, ham diag time = 2.0869290828704834
[iter 6] dim= 17828  Es=[-46.155592582752 -46.155592582719]  |dE0|=6.160e-06
[conv] reached |dE| < 1e-05
Found 1 S_z blocks: [0.0]
  Processing Sz=0.0 block of size 17828x17828
DEBUG: build ham time = 0.5136590003967285
DEBUG: finished rearranging vectors
sci total time : 14.15587830543518
energies = [-46.156 -46.156], e0 = -46.15559258275189
len basis = 17828
len(basis(psis0)) = 17828
target_indices = [0, 1, 38, 39]
 Founds blocks : [[0], [1], [2], [3]]
  Symmetry: is_diagonal=True. Found 1 unique group(s) of blocks.
  Computing representative g_(0,0) via Scalar CF...
DEBUG: build ham time = 0.6480560302734375
DEBUG: build ham time = 0.7117733955383301
target_indices = [0, 1, 38, 39]
 Founds blocks : [[0], [1], [2], [3]]
  Symmetry: is_diagonal=True. Found 1 unique group(s) of blocks.
  Computing representative g_(0,0) via Scalar CF...
DEBUG: build ham time = 0.6279010772705078
DEBUG: build ham time = 0.6971127986907959
rdm : 
[[0.5+0.j 0. +0.j 0. +0.j 0. +0.j]
 [0. +0.j 0.5+0.j 0. +0.j 0. +0.j]
 [0. +0.j 0. +0.j 0.5+0.j 0. +0.j]
 [0. +0.j 0. +0.j 0. +0.j 0.5+0.j]]
impurity occupation: (2.000005041948215+0j)
total occupation : (2.0000050419482145+0j)

Thermally-averaged calculation finished.
Data saved to 'dump/A_18'
